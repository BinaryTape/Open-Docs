import{_ as d,C as h,c as g,o as c,j as i,G as t,ag as p,a,w as n}from"./chunks/framework.Bksy39di.js";const f=JSON.parse('{"title":"クライアントエンジン","description":"","frontmatter":{},"headers":[],"relativePath":"ja/ktor/client-engines.md","filePath":"ja/ktor/client-engines.md","lastUpdated":1755457140000}'),E={name:"ja/ktor/client-engines.md"};function y(F,s,u,C,v,m){const r=h("show-structure"),o=h("link-summary"),e=h("code-block"),l=h("TabItem"),k=h("Tabs");return c(),g("div",null,[s[28]||(s[28]=i("h1",{id:"クライアントエンジン",tabindex:"-1"},[a("クライアントエンジン "),i("a",{class:"header-anchor",href:"#クライアントエンジン","aria-label":'Permalink to "クライアントエンジン"'},"​")],-1)),t(r,{for:"chapter",depth:"2"}),t(o,null,{default:n(()=>s[0]||(s[0]=[a(" ネットワークリクエストを処理するエンジンについて学習します。 ")])),_:1}),s[29]||(s[29]=p(`<p><a href="./client-create-and-configure">Ktor HTTPクライアント</a>は、JVM、<a href="https://kotlinlang.org/docs/android-overview.html" target="_blank" rel="noreferrer">Android</a>、<a href="https://kotlinlang.org/docs/js-overview.html" target="_blank" rel="noreferrer">JavaScript</a>、<a href="https://kotlinlang.org/docs/native-overview.html" target="_blank" rel="noreferrer">Native</a>など、さまざまなプラットフォームで使用できます。特定のプラットフォームでは、ネットワークリクエストを処理する特定のエンジンが必要になる場合があります。 例えば、JVMアプリケーションには<code>Apache</code>または<code>Jetty</code>、Androidには<code>OkHttp</code>または<code>Android</code>、Kotlin/Nativeをターゲットとするデスクトップアプリケーションには<code>Curl</code>などを使用できます。異なるエンジンには特定の機能があり、異なる構成オプションが提供される場合があります。</p><h2 id="requirements" tabindex="-1">要件と制限 <a class="header-anchor" href="#requirements" aria-label="Permalink to &quot;要件と制限 {id=&quot;requirements&quot;}&quot;">​</a></h2><h3 id="platforms" tabindex="-1">サポートされるプラットフォーム <a class="header-anchor" href="#platforms" aria-label="Permalink to &quot;サポートされるプラットフォーム {id=&quot;platforms&quot;}&quot;">​</a></h3><p>以下の表は、各エンジンがサポートする<a href="./client-supported-platforms">プラットフォーム</a>を示しています。</p><table tabindex="0"><thead><tr><th>エンジン</th><th>プラットフォーム</th></tr></thead><tbody><tr><td>Apache</td><td><a href="#jvm">JVM</a></td></tr><tr><td>Java</td><td><a href="#jvm">JVM</a></td></tr><tr><td>Jetty</td><td><a href="#jvm">JVM</a></td></tr><tr><td>Android</td><td><a href="#jvm">JVM</a>, <a href="#jvm-android">Android</a></td></tr><tr><td>OkHttp</td><td><a href="#jvm">JVM</a>, <a href="#jvm-android">Android</a></td></tr><tr><td>Darwin</td><td><a href="#native">Native</a></td></tr><tr><td>WinHttp</td><td><a href="#native">Native</a></td></tr><tr><td>Curl</td><td><a href="#native">Native</a></td></tr><tr><td>CIO</td><td><a href="#jvm">JVM</a>, <a href="#jvm-android">Android</a>, <a href="#native">Native</a></td></tr><tr><td>Js</td><td><a href="#js">JavaScript</a></td></tr></tbody></table><h3 id="minimal-version" tabindex="-1">サポートされるAndroid/Javaバージョン <a class="header-anchor" href="#minimal-version" aria-label="Permalink to &quot;サポートされるAndroid/Javaバージョン {id=&quot;minimal-version&quot;}&quot;">​</a></h3><p>JVMまたはJVMとAndroidの両方をターゲットとするクライアントエンジンは、以下のAndroid/Javaバージョンをサポートします。</p><table tabindex="0"><thead><tr><th>エンジン</th><th>Androidバージョン</th><th>Javaバージョン</th></tr></thead><tbody><tr><td>Apache</td><td></td><td>8+</td></tr><tr><td>Java</td><td></td><td>11+</td></tr><tr><td>Jetty</td><td></td><td>11+</td></tr><tr><td>CIO</td><td>7.0+ <sup>*</sup></td><td>8+</td></tr><tr><td>Android</td><td>1.x+</td><td>8+</td></tr><tr><td>OkHttp</td><td>5.0+</td><td>8+</td></tr></tbody></table><p><em>* 古いAndroidバージョンでCIOエンジンを使用するには、<a href="https://developer.android.com/studio/write/java8-support" target="_blank" rel="noreferrer">Java 8 API desugaring</a>を有効にする必要があります。</em></p><h3 id="limitations" tabindex="-1">制限事項 <a class="header-anchor" href="#limitations" aria-label="Permalink to &quot;制限事項 {id=&quot;limitations&quot;}&quot;">​</a></h3><p>以下の表は、特定のエンジンがHTTP/2と<a href="./client-websockets">WebSockets</a>をサポートしているかどうかを示しています。</p><table tabindex="0"><thead><tr><th>エンジン</th><th>HTTP/2</th><th>WebSockets</th></tr></thead><tbody><tr><td>Apache</td><td>✅️ <em>(Apache5の場合)</em></td><td>✖️</td></tr><tr><td>Java</td><td>✅</td><td>✅️</td></tr><tr><td>Jetty</td><td>✅</td><td>✖️</td></tr><tr><td>CIO</td><td>✖️</td><td>✅</td></tr><tr><td>Android</td><td>✖️</td><td>✖️</td></tr><tr><td>OkHttp</td><td>✅</td><td>✅</td></tr><tr><td>Js</td><td>✅</td><td>✅</td></tr><tr><td>Darwin</td><td>✅</td><td>✅</td></tr><tr><td>WinHttp</td><td>✅</td><td>✅</td></tr><tr><td>Curl</td><td>✅</td><td>✅</td></tr></tbody></table><p>また、一般的なクライアント構成や特定のプラグインの使用に影響する以下の制限事項も考慮する必要があります。</p><ul><li>エンジンがHTTP/2をサポートしている場合、エンジン構成をカスタマイズすることで有効にできます（<a href="#java">Java</a>エンジンの例を参照）。</li><li>Ktorクライアントで<a href="./client-ssl">SSL</a>を構成するには、選択したエンジンの構成をカスタマイズする必要があります。</li><li>一部のエンジンは<a href="./client-proxy#supported_engines">プロキシ</a>をサポートしていません。</li><li><a href="./client-logging">Logging</a>プラグインは、異なるプラットフォーム向けに異なるロガータイプを提供します。</li><li><a href="./client-timeout#limitations">HttpTimeout</a>プラグインには、特定のエンジンに対するいくつかの制限があります。</li></ul><h2 id="dependencies" tabindex="-1">エンジンの依存関係を追加する <a class="header-anchor" href="#dependencies" aria-label="Permalink to &quot;エンジンの依存関係を追加する {id=&quot;dependencies&quot;}&quot;">​</a></h2><p><a href="./client-dependencies">ktor-client-core</a>アーティファクトとは別に、Ktorクライアントは各エンジンに特定の依存関係を追加する必要があります。サポートされている各プラットフォームについて、利用可能なエンジンと必要な依存関係を対応するセクションで確認できます。</p><ul><li><a href="#jvm">JVM</a></li><li><a href="#jvm-android">JVMとAndroid</a></li><li><a href="#js">JavaScript</a></li><li><a href="#native">Native</a></li></ul><div class="note custom-block"><p class="custom-block-title">NOTE</p><p>異なるエンジン向けに、Ktorは<code>-jvm</code>や<code>-js</code>などのサフィックスを持つプラットフォーム固有のアーティファクト（例: <code>ktor-client-cio-jvm</code>）を提供します。Gradleは指定されたプラットフォームに適したアーティファクトを解決しますが、Mavenはこの機能をサポートしていません。これは、Mavenの場合、プラットフォーム固有のサフィックスを手動で追加する必要があることを意味します。</p></div><h2 id="create" tabindex="-1">指定されたエンジンでクライアントを作成する <a class="header-anchor" href="#create" aria-label="Permalink to &quot;指定されたエンジンでクライアントを作成する {id=&quot;create&quot;}&quot;">​</a></h2><p>特定のエンジンでHTTPクライアントを作成するには、<a href="https://api.ktor.io/ktor-client/ktor-client-core/io.ktor.client/-http-client/index.html" target="_blank" rel="noreferrer">HttpClient</a>コンストラクターにエンジンクラスを引数として渡します。例えば、<code>CIO</code>エンジンでクライアントを作成するには、次のようにします。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.cio.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CIO)</span></span></code></pre></div><h3 id="default" tabindex="-1">デフォルトエンジン <a class="header-anchor" href="#default" aria-label="Permalink to &quot;デフォルトエンジン {id=&quot;default&quot;}&quot;">​</a></h3><p>引数なしで<code>HttpClient</code>コンストラクターを呼び出すと、クライアントは<a href="#dependencies">ビルドスクリプトで追加された</a>アーティファクトに応じてエンジンを自動的に選択します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>これはマルチプラットフォームプロジェクトに役立ちます。例えば、<a href="./client-create-multiplatform-application">AndroidとiOS</a>の両方をターゲットとするプロジェクトの場合、<code>androidMain</code>ソースセットに<a href="#jvm-android">Android</a>依存関係を、<code>iosMain</code>ソースセットに<a href="#darwin">Darwin</a>依存関係を追加できます。必要な依存関係はコンパイル時に選択されます。</p><h2 id="configure" tabindex="-1">エンジンを構成する <a class="header-anchor" href="#configure" aria-label="Permalink to &quot;エンジンを構成する {id=&quot;configure&quot;}&quot;">​</a></h2><p><code>engine</code>メソッドを使用してエンジンを構成できます。すべてのエンジンは、<a href="https://api.ktor.io/ktor-client/ktor-client-core/io.ktor.client.engine/-http-client-engine-config/index.html" target="_blank" rel="noreferrer">HttpClientEngineConfig</a>によって公開されるいくつかの共通プロパティを共有しています。例:</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // this: HttpClientEngineConfig</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        threadsCount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        pipelining </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>特定のエンジンを構成する方法については、以下の対応するセクションを参照してください。</p><h2 id="jvm" tabindex="-1">JVM <a class="header-anchor" href="#jvm" aria-label="Permalink to &quot;JVM {id=&quot;jvm&quot;}&quot;">​</a></h2><p>このセクションでは、JVMで利用可能なエンジンについて見ていきます。</p><h3 id="apache" tabindex="-1">Apache <a class="header-anchor" href="#apache" aria-label="Permalink to &quot;Apache {id=&quot;apache&quot;}&quot;">​</a></h3><p><code>Apache</code>エンジンはHTTP/1.1をサポートし、複数の構成オプションを提供します。 HTTP/2のサポートが必要な場合は<code>Apache5</code>エンジンも使用できます。<code>Apache5</code>はデフォルトでHTTP/2が有効になっています。</p>`,33)),i("ol",null,[i("li",null,[s[1]||(s[1]=i("p",null,[i("code",null,"ktor-client-apache5"),a("または"),i("code",null,"ktor-client-apache"),a("の依存関係を追加します。")],-1)),t(k,{group:"languages"},{default:n(()=>[t(l,{title:"Gradle (Kotlin)","group-key":"kotlin"},{default:n(()=>[t(e,{lang:"Kotlin",code:'               implementation("io.ktor:ktor-client-apache5:$ktor_version")'})]),_:1}),t(l,{title:"Gradle (Groovy)","group-key":"groovy"},{default:n(()=>[t(e,{lang:"Groovy",code:'               implementation "io.ktor:ktor-client-apache5:$ktor_version"'})]),_:1}),t(l,{title:"Maven","group-key":"maven"},{default:n(()=>[t(e,{lang:"XML",code:`               <dependency>
                   <groupId>io.ktor</groupId>
                   <artifactId>ktor-client-apache5-jvm</artifactId>
                   <version>\${ktor_version}</version>
               </dependency>`})]),_:1})]),_:1})]),i("li",null,[s[4]||(s[4]=i("p",null,[i("code",null,"Apache5"),a("/"),i("code",null,"Apache"),a("クラスを"),i("code",null,"HttpClient"),a("コンストラクターの引数として渡します。")],-1)),t(k,{group:"apache_version"},{default:n(()=>[t(l,{title:"Apache5"},{default:n(()=>s[2]||(s[2]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," io.ktor.client."),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"*")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," io.ktor.client.engine.apache5."),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"*")]),a(`
`),i("span",{class:"line"}),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HttpClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Apache5)")])])])],-1)])),_:1}),t(l,{title:"Apache"},{default:n(()=>s[3]||(s[3]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," io.ktor.client."),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"*")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," io.ktor.client.engine.apache."),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"*")]),a(`
`),i("span",{class:"line"}),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HttpClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Apache)")])])])],-1)])),_:1})]),_:1})]),i("li",null,[s[7]||(s[7]=i("p",null,[a("エンジンを構成するには、"),i("code",null,"Apache5EngineConfig"),a("/"),i("code",null,"ApacheEngineConfig"),a("によって公開される設定を"),i("code",null,"engine"),a("メソッドに渡します。")],-1)),t(k,{group:"apache_version"},{default:n(()=>[t(l,{title:"Apache5"},{default:n(()=>s[5]||(s[5]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," io.ktor.client."),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"*")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," io.ktor.client.engine.apache5."),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"*")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," org.apache.hc.core5.http."),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"*")]),a(`
`),i("span",{class:"line"}),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HttpClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Apache5) {")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    engine"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // this: Apache5EngineConfig")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        followRedirects "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        socketTimeout "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 10_000")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        connectTimeout "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 10_000")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        connectionRequestTimeout "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 20_000")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        customizeClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // this: HttpAsyncClientBuilder")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            setProxy"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"HttpHost"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"127.0.0.1"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"8080"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"))")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // ...")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        customizeRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // this: RequestConfig.Builder")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1}),t(l,{title:"Apache"},{default:n(()=>s[6]||(s[6]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," io.ktor.client."),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"*")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," io.ktor.client.engine.apache."),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"*")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," org.apache.http.HttpHost")]),a(`
`),i("span",{class:"line"}),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HttpClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Apache) {")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    engine"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // this: ApacheEngineConfig")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        followRedirects "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        socketTimeout "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 10_000")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        connectTimeout "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 10_000")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        connectionRequestTimeout "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 20_000")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        customizeClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // this: HttpAsyncClientBuilder")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            setProxy"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"HttpHost"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"127.0.0.1"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"8080"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"))")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            setMaxConnTotal"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1000"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            setMaxConnPerRoute"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"100"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // ...")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        customizeRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // this: RequestConfig.Builder")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1})])]),s[30]||(s[30]=i("h3",{id:"java",tabindex:"-1"},[a("Java "),i("a",{class:"header-anchor",href:"#java","aria-label":'Permalink to "Java {id="java"}"'},"​")],-1)),s[31]||(s[31]=i("p",null,[i("code",null,"Java"),a("エンジンは、Java 11で導入された"),i("a",{href:"https://openjdk.java.net/groups/net/httpclient/intro.html",target:"_blank",rel:"noreferrer"},"Java HTTPクライアント"),a("を使用します。これを使用するには、以下の手順に従います。")],-1)),i("ol",null,[i("li",null,[s[8]||(s[8]=i("p",null,[i("code",null,"ktor-client-java"),a("の依存関係を追加します。")],-1)),t(k,{group:"languages"},{default:n(()=>[t(l,{title:"Gradle (Kotlin)","group-key":"kotlin"},{default:n(()=>[t(e,{lang:"Kotlin",code:'               implementation("io.ktor:ktor-client-java:$ktor_version")'})]),_:1}),t(l,{title:"Gradle (Groovy)","group-key":"groovy"},{default:n(()=>[t(e,{lang:"Groovy",code:'               implementation "io.ktor:ktor-client-java:$ktor_version"'})]),_:1}),t(l,{title:"Maven","group-key":"maven"},{default:n(()=>[t(e,{lang:"XML",code:`               <dependency>
                   <groupId>io.ktor</groupId>
                   <artifactId>ktor-client-java-jvm</artifactId>
                   <version>\${ktor_version}</version>
               </dependency>`})]),_:1})]),_:1})]),s[9]||(s[9]=p(`<li><p><a href="https://api.ktor.io/ktor-client/ktor-client-java/io.ktor.client.engine.java/-java/index.html" target="_blank" rel="noreferrer">Java</a>クラスを<code>HttpClient</code>コンストラクターの引数として渡します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.java.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Java)</span></span></code></pre></div></li><li><p>エンジンを構成するには、<a href="https://api.ktor.io/ktor-client/ktor-client-java/io.ktor.client.engine.java/-java-http-config/index.html" target="_blank" rel="noreferrer">JavaHttpConfig</a>によって公開される設定を<code>engine</code>メソッドに渡します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.java.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Java) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // this: JavaHttpConfig</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        threadsCount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        pipelining </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ProxyBuilder.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://proxy-server.com/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        protocolVersion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> java.net.http.HttpClient.Version.HTTP_2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li>`,2))]),s[32]||(s[32]=i("h3",{id:"jetty",tabindex:"-1"},[a("Jetty "),i("a",{class:"header-anchor",href:"#jetty","aria-label":'Permalink to "Jetty {id="jetty"}"'},"​")],-1)),s[33]||(s[33]=i("p",null,[i("code",null,"Jetty"),a("エンジンはHTTP/2のみをサポートし、以下の方法で構成できます。")],-1)),i("ol",null,[i("li",null,[s[10]||(s[10]=i("p",null,[i("code",null,"ktor-client-jetty-jakarta"),a("の依存関係を追加します。")],-1)),t(k,{group:"languages"},{default:n(()=>[t(l,{title:"Gradle (Kotlin)","group-key":"kotlin"},{default:n(()=>[t(e,{lang:"Kotlin",code:'               implementation("io.ktor:ktor-client-jetty-jakarta:$ktor_version")'})]),_:1}),t(l,{title:"Gradle (Groovy)","group-key":"groovy"},{default:n(()=>[t(e,{lang:"Groovy",code:'               implementation "io.ktor:ktor-client-jetty-jakarta:$ktor_version"'})]),_:1}),t(l,{title:"Maven","group-key":"maven"},{default:n(()=>[t(e,{lang:"XML",code:`               <dependency>
                   <groupId>io.ktor</groupId>
                   <artifactId>ktor-client-jetty-jakarta-jvm</artifactId>
                   <version>\${ktor_version}</version>
               </dependency>`})]),_:1})]),_:1})]),s[11]||(s[11]=p(`<li><p><a href="https://api.ktor.io/ktor-client/ktor-client-jetty-jakarta/io.ktor.client.engine.jetty.jakarta/-jetty/index.html" target="_blank" rel="noreferrer">Jetty</a>クラスを<code>HttpClient</code>コンストラクターの引数として渡します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.jetty.jakarta.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Jetty)</span></span></code></pre></div></li><li><p>エンジンを構成するには、<a href="https://api.ktor.io/ktor-client/ktor-client-jetty-jakarta/io.ktor.client.engine.jetty.jakarta/-jetty-engine-config/index.html" target="_blank" rel="noreferrer">JettyEngineConfig</a>によって公開される設定を<code>engine</code>メソッドに渡します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.jetty.jakarta.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> org.eclipse.jetty.util.ssl.SslContextFactory</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Jetty) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // this: JettyEngineConfig</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        sslContextFactory </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SslContextFactory.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Client</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        clientCacheSize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 12</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li>`,2))]),s[34]||(s[34]=i("h2",{id:"jvm-android",tabindex:"-1"},[a("JVMとAndroid "),i("a",{class:"header-anchor",href:"#jvm-android","aria-label":'Permalink to "JVMとAndroid {id="jvm-android"}"'},"​")],-1)),s[35]||(s[35]=i("p",null,"このセクションでは、JVM/Androidで利用可能なエンジンとその構成について見ていきます。",-1)),s[36]||(s[36]=i("h3",{id:"android",tabindex:"-1"},[a("Android "),i("a",{class:"header-anchor",href:"#android","aria-label":'Permalink to "Android {id="android"}"'},"​")],-1)),s[37]||(s[37]=i("p",null,[i("code",null,"Android"),a("エンジンはAndroidをターゲットとしており、以下の方法で構成できます。")],-1)),i("ol",null,[i("li",null,[s[12]||(s[12]=i("p",null,[i("code",null,"ktor-client-android"),a("の依存関係を追加します。")],-1)),t(k,{group:"languages"},{default:n(()=>[t(l,{title:"Gradle (Kotlin)","group-key":"kotlin"},{default:n(()=>[t(e,{lang:"Kotlin",code:'               implementation("io.ktor:ktor-client-android:$ktor_version")'})]),_:1}),t(l,{title:"Gradle (Groovy)","group-key":"groovy"},{default:n(()=>[t(e,{lang:"Groovy",code:'               implementation "io.ktor:ktor-client-android:$ktor_version"'})]),_:1}),t(l,{title:"Maven","group-key":"maven"},{default:n(()=>[t(e,{lang:"XML",code:`               <dependency>
                   <groupId>io.ktor</groupId>
                   <artifactId>ktor-client-android-jvm</artifactId>
                   <version>\${ktor_version}</version>
               </dependency>`})]),_:1})]),_:1})]),s[13]||(s[13]=p(`<li><p><a href="https://api.ktor.io/ktor-client/ktor-client-android/io.ktor.client.engine.android/-android/index.html" target="_blank" rel="noreferrer">Android</a>クラスを<code>HttpClient</code>コンストラクターの引数として渡します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.android.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Android)</span></span></code></pre></div></li><li><p>エンジンを構成するには、<a href="https://api.ktor.io/ktor-client/ktor-client-android/io.ktor.client.engine.android/-android-engine-config/index.html" target="_blank" rel="noreferrer">AndroidEngineConfig</a>によって公開される設定を<code>engine</code>メソッドに渡します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.android.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> java.net.Proxy</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> java.net.InetSocketAddress</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Android) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // this: AndroidEngineConfig</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        connectTimeout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100_000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        socketTimeout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100_000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proxy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Proxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Proxy.Type.HTTP, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">InetSocketAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;localhost&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8080</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li>`,2))]),s[38]||(s[38]=i("h3",{id:"okhttp",tabindex:"-1"},[a("OkHttp "),i("a",{class:"header-anchor",href:"#okhttp","aria-label":'Permalink to "OkHttp {id="okhttp"}"'},"​")],-1)),s[39]||(s[39]=i("p",null,[i("code",null,"OkHttp"),a("エンジンはOkHttpに基づいており、以下の方法で構成できます。")],-1)),i("ol",null,[i("li",null,[s[14]||(s[14]=i("p",null,[i("code",null,"ktor-client-okhttp"),a("の依存関係を追加します。")],-1)),t(k,{group:"languages"},{default:n(()=>[t(l,{title:"Gradle (Kotlin)","group-key":"kotlin"},{default:n(()=>[t(e,{lang:"Kotlin",code:'               implementation("io.ktor:ktor-client-okhttp:$ktor_version")'})]),_:1}),t(l,{title:"Gradle (Groovy)","group-key":"groovy"},{default:n(()=>[t(e,{lang:"Groovy",code:'               implementation "io.ktor:ktor-client-okhttp:$ktor_version"'})]),_:1}),t(l,{title:"Maven","group-key":"maven"},{default:n(()=>[t(e,{lang:"XML",code:`               <dependency>
                   <groupId>io.ktor</groupId>
                   <artifactId>ktor-client-okhttp-jvm</artifactId>
                   <version>\${ktor_version}</version>
               </dependency>`})]),_:1})]),_:1})]),s[15]||(s[15]=p(`<li><p><a href="https://api.ktor.io/ktor-client/ktor-client-okhttp/io.ktor.client.engine.okhttp/-ok-http/index.html" target="_blank" rel="noreferrer">OkHttp</a>クラスを<code>HttpClient</code>コンストラクターの引数として渡します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.okhttp.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(OkHttp)</span></span></code></pre></div></li><li><p>エンジンを構成するには、<a href="https://api.ktor.io/ktor-client/ktor-client-okhttp/io.ktor.client.engine.okhttp/-ok-http-config/index.html" target="_blank" rel="noreferrer">OkHttpConfig</a>によって公開される設定を<code>engine</code>メソッドに渡します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.okhttp.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(OkHttp) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // this: OkHttpConfig</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // this: OkHttpClient.Builder</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            followRedirects</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        addInterceptor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(interceptor)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        addNetworkInterceptor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(interceptor)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        preconfigured </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> okHttpClientInstance</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li>`,2))]),s[40]||(s[40]=p('<h2 id="native" tabindex="-1">Native <a class="header-anchor" href="#native" aria-label="Permalink to &quot;Native {id=&quot;native&quot;}&quot;">​</a></h2><p>このセクションでは、<a href="https://kotlinlang.org/docs/native-overview.html" target="_blank" rel="noreferrer">Kotlin/Native</a>をターゲットとするエンジンの構成方法について見ていきます。</p><blockquote><p>Kotlin/NativeプロジェクトでKtorを使用するには、<a href="https://kotlinlang.org/docs/native-memory-manager.html" target="_blank" rel="noreferrer">新しいメモリマネージャー</a>が必要です。これはKotlin 1.7.20以降でデフォルトで有効になっています。</p></blockquote><p id="newmm-note"></p><h3 id="darwin" tabindex="-1">Darwin <a class="header-anchor" href="#darwin" aria-label="Permalink to &quot;Darwin {id=&quot;darwin&quot;}&quot;">​</a></h3><p><code>Darwin</code>エンジンは<a href="https://en.wikipedia.org/wiki/Darwin_(operating_system)" target="_blank" rel="noreferrer">Darwinベース</a>のオペレーティングシステム（macOS、iOS、tvOSなど）をターゲットとし、内部で<a href="https://developer.apple.com/documentation/foundation/nsurlsession" target="_blank" rel="noreferrer">NSURLSession</a>を使用します。<code>Darwin</code>エンジンを使用するには、以下の手順に従います。</p>',6)),i("ol",null,[i("li",null,[s[16]||(s[16]=i("p",null,[i("code",null,"ktor-client-darwin"),a("の依存関係を追加します。")],-1)),t(k,{group:"languages"},{default:n(()=>[t(l,{title:"Gradle (Kotlin)","group-key":"kotlin"},{default:n(()=>[t(e,{lang:"Kotlin",code:'               implementation("io.ktor:ktor-client-darwin:$ktor_version")'})]),_:1}),t(l,{title:"Gradle (Groovy)","group-key":"groovy"},{default:n(()=>[t(e,{lang:"Groovy",code:'               implementation "io.ktor:ktor-client-darwin:$ktor_version"'})]),_:1}),t(l,{title:"Maven","group-key":"maven"},{default:n(()=>[t(e,{lang:"XML",code:`               <dependency>
                   <groupId>io.ktor</groupId>
                   <artifactId>ktor-client-darwin-macosx64</artifactId>
                   <version>\${ktor_version}</version>
               </dependency>`})]),_:1})]),_:1})]),s[17]||(s[17]=p(`<li><p><code>Darwin</code>クラスを<code>HttpClient</code>コンストラクターの引数として渡します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.darwin.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Darwin)</span></span></code></pre></div></li><li><p>エンジンを構成するには、<a href="https://api.ktor.io/ktor-client/ktor-client-darwin/io.ktor.client.engine.darwin/-darwin-client-engine-config/index.html" target="_blank" rel="noreferrer">DarwinClientEngineConfig</a>によって公開される設定を<code>engine</code>関数に渡します。 例えば、<code>configureRequest</code>関数を使用して<code>NSMutableURLRequest</code>にアクセスしたり、<code>configureSession</code>を使用してセッション構成をカスタマイズしたりできます。以下のコードスニペットは<code>configureRequest</code>の使用方法を示しています。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Darwin) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        configureRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            setAllowsCellularAccess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>完全な例は<a href="https://github.com/ktorio/ktor-documentation/tree/3.2.3/codeSnippets/snippets/client-engine-darwin" target="_blank" rel="noreferrer">client-engine-darwin</a>で見つけることができます。</p></li>`,2))]),s[41]||(s[41]=i("h3",{id:"winhttp",tabindex:"-1"},[a("WinHttp "),i("a",{class:"header-anchor",href:"#winhttp","aria-label":'Permalink to "WinHttp {id="winhttp"}"'},"​")],-1)),s[42]||(s[42]=i("p",null,[i("code",null,"WinHttp"),a("エンジンはWindowsベースのオペレーティングシステムをターゲットとしています。 "),i("code",null,"WinHttp"),a("エンジンを使用するには、以下の手順に従います。")],-1)),i("ol",null,[i("li",null,[s[18]||(s[18]=i("p",null,[i("code",null,"ktor-client-winhttp"),a("の依存関係を追加します。")],-1)),t(k,{group:"languages"},{default:n(()=>[t(l,{title:"Gradle (Kotlin)","group-key":"kotlin"},{default:n(()=>[t(e,{lang:"Kotlin",code:'               implementation("io.ktor:ktor-client-winhttp:$ktor_version")'})]),_:1}),t(l,{title:"Gradle (Groovy)","group-key":"groovy"},{default:n(()=>[t(e,{lang:"Groovy",code:'               implementation "io.ktor:ktor-client-winhttp:$ktor_version"'})]),_:1}),t(l,{title:"Maven","group-key":"maven"},{default:n(()=>[t(e,{lang:"XML",code:`               <dependency>
                   <groupId>io.ktor</groupId>
                   <artifactId>ktor-client-winhttp-mingwx64</artifactId>
                   <version>\${ktor_version}</version>
               </dependency>`})]),_:1})]),_:1})]),s[19]||(s[19]=p(`<li><p><code>WinHttp</code>クラスを<code>HttpClient</code>コンストラクターの引数として渡します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.winhttp.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WinHttp)</span></span></code></pre></div></li><li><p>エンジンを構成するには、<a href="https://api.ktor.io/ktor-client/ktor-client-winhttp/io.ktor.client.engine.winhttp/-winhttp-client-engine-config/index.html" target="_blank" rel="noreferrer">WinHttpClientEngineConfig</a>によって公開される設定を<code>engine</code>関数に渡します。 例えば、<code>protocolVersion</code>プロパティを使用してHTTPバージョンを変更できます。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WinHttp) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        protocolVersion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HttpProtocolVersion.HTTP_1_1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>完全な例は<a href="https://github.com/ktorio/ktor-documentation/tree/3.2.3/codeSnippets/snippets/client-engine-winhttp" target="_blank" rel="noreferrer">client-engine-winhttp</a>で見つけることができます。</p></li>`,2))]),s[43]||(s[43]=p('<h3 id="curl" tabindex="-1">Curl <a class="header-anchor" href="#curl" aria-label="Permalink to &quot;Curl {id=&quot;curl&quot;}&quot;">​</a></h3><p>デスクトッププラットフォーム向けに、Ktorは<code>Curl</code>エンジンも提供しています。このエンジンは以下のプラットフォームでサポートされています: <code>linuxX64</code>、<code>linuxArm64</code>、<code>macosX64</code>、<code>macosArm64</code>、<code>mingwX64</code>。<code>Curl</code>エンジンを使用するには、以下の手順に従います。</p>',2)),i("ol",null,[s[21]||(s[21]=p('<li><p><a href="https://curl.se/libcurl/" target="_blank" rel="noreferrer">libcurlライブラリ</a>をインストールします。</p><blockquote><p>Linuxでは、libcurlの<code>gnutls</code>バージョンをインストールする必要があります。 Ubuntuにこのバージョンをインストールするには、以下を実行します。</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libcurl4-gnutls-dev</span></span></code></pre></div><blockquote><p>Windowsでは、<a href="./FAQ#native-curl">MinGW/MSYS2</a>の<code>curl</code>バイナリを検討すると良いでしょう。</p></blockquote></li>',1)),i("li",null,[s[20]||(s[20]=i("p",null,[i("code",null,"ktor-client-curl"),a("の依存関係を追加します。")],-1)),t(k,{group:"languages"},{default:n(()=>[t(l,{title:"Gradle (Kotlin)","group-key":"kotlin"},{default:n(()=>[t(e,{lang:"Kotlin",code:'               implementation("io.ktor:ktor-client-curl:$ktor_version")'})]),_:1}),t(l,{title:"Gradle (Groovy)","group-key":"groovy"},{default:n(()=>[t(e,{lang:"Groovy",code:'               implementation "io.ktor:ktor-client-curl:$ktor_version"'})]),_:1}),t(l,{title:"Maven","group-key":"maven"},{default:n(()=>[t(e,{lang:"XML",code:`               <dependency>
                   <groupId>io.ktor</groupId>
                   <artifactId>ktor-client-curl-macosx64</artifactId>
                   <version>\${ktor_version}</version>
               </dependency>`})]),_:1})]),_:1})]),s[22]||(s[22]=p(`<li><p><code>Curl</code>クラスを<code>HttpClient</code>コンストラクターの引数として渡します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.curl.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Curl)</span></span></code></pre></div></li><li><p>エンジンを構成するには、<code>CurlClientEngineConfig</code>によって公開される設定を<code>engine</code>メソッドに渡します。 以下のコードスニペットは、テスト目的でSSL検証を無効にする方法を示しています。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Curl) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        sslVerify </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>完全な例は<a href="https://github.com/ktorio/ktor-documentation/tree/3.2.3/codeSnippets/snippets/client-engine-curl" target="_blank" rel="noreferrer">client-engine-curl</a>で見つけることができます。</p></li>`,2))]),s[44]||(s[44]=i("h2",{id:"jvm-android-native",tabindex:"-1"},[a("JVM、Android、Native "),i("a",{class:"header-anchor",href:"#jvm-android-native","aria-label":'Permalink to "JVM、Android、Native {id="jvm-android-native"}"'},"​")],-1)),s[45]||(s[45]=i("h3",{id:"cio",tabindex:"-1"},[a("CIO "),i("a",{class:"header-anchor",href:"#cio","aria-label":'Permalink to "CIO {id="cio"}"'},"​")],-1)),s[46]||(s[46]=i("p",null,"CIOは、JVM、Android、Nativeプラットフォームで使用できる完全に非同期のコルーチンベースのエンジンです。現在のところ、HTTP/1.xのみをサポートしています。これを使用するには、以下の手順に従います。",-1)),i("ol",null,[i("li",null,[s[23]||(s[23]=i("p",null,[i("code",null,"ktor-client-cio"),a("の依存関係を追加します。")],-1)),t(k,{group:"languages"},{default:n(()=>[t(l,{title:"Gradle (Kotlin)","group-key":"kotlin"},{default:n(()=>[t(e,{lang:"Kotlin",code:'               implementation("io.ktor:ktor-client-cio:$ktor_version")'})]),_:1}),t(l,{title:"Gradle (Groovy)","group-key":"groovy"},{default:n(()=>[t(e,{lang:"Groovy",code:'               implementation "io.ktor:ktor-client-cio:$ktor_version"'})]),_:1}),t(l,{title:"Maven","group-key":"maven"},{default:n(()=>[t(e,{lang:"XML",code:`               <dependency>
                   <groupId>io.ktor</groupId>
                   <artifactId>ktor-client-cio-jvm</artifactId>
                   <version>\${ktor_version}</version>
               </dependency>`})]),_:1})]),_:1})]),s[24]||(s[24]=p(`<li><p><a href="https://api.ktor.io/ktor-client/ktor-client-cio/io.ktor.client.engine.cio/-c-i-o/index.html" target="_blank" rel="noreferrer">CIO</a>クラスを<code>HttpClient</code>コンストラクターの引数として渡します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.cio.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CIO)</span></span></code></pre></div></li><li><p>エンジンを構成するには、<a href="https://api.ktor.io/ktor-client/ktor-client-cio/io.ktor.client.engine.cio/-c-i-o-engine-config/index.html" target="_blank" rel="noreferrer">CIOEngineConfig</a>によって公開される設定を<code>engine</code>メソッドに渡します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.cio.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.network.tls.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CIO) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // this: CIOEngineConfig</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        maxConnectionsCount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        endpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // this: EndpointConfig</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            maxConnectionsPerRoute </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            pipelineMaxSize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            keepAliveTime </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            connectTimeout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            connectAttempts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        https</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // this: TLSConfigBuilder</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            serverName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;api.ktor.io&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            cipherSuites </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CIOCipherSuites.SupportedSuites</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            trustManager </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> myCustomTrustManager</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            random </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mySecureRandom</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            addKeyStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(myKeyStore, myKeyStorePassword)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li>`,2))]),s[47]||(s[47]=i("h2",{id:"js",tabindex:"-1"},[a("JavaScript "),i("a",{class:"header-anchor",href:"#js","aria-label":'Permalink to "JavaScript {id="js"}"'},"​")],-1)),s[48]||(s[48]=i("p",null,[i("code",null,"Js"),a("エンジンは"),i("a",{href:"https://kotlinlang.org/docs/js-overview.html",target:"_blank",rel:"noreferrer"},"JavaScriptプロジェクト"),a("で使用できます。このエンジンは、ブラウザアプリケーションには"),i("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API",target:"_blank",rel:"noreferrer"},"fetch API"),a("を、Node.jsには"),i("code",null,"node-fetch"),a("を使用します。これを使用するには、以下の手順に従います。")],-1)),i("ol",null,[i("li",null,[s[25]||(s[25]=i("p",null,[i("code",null,"ktor-client-js"),a("の依存関係を追加します。")],-1)),s[26]||(s[26]=i("var",{name:"target",value:""},null,-1)),t(k,{group:"languages"},{default:n(()=>[t(l,{title:"Gradle (Kotlin)","group-key":"kotlin"},{default:n(()=>[t(e,{lang:"Kotlin",code:'               implementation("io.ktor:ktor-client-js:$ktor_version")'})]),_:1}),t(l,{title:"Gradle (Groovy)","group-key":"groovy"},{default:n(()=>[t(e,{lang:"Groovy",code:'               implementation "io.ktor:ktor-client-js:$ktor_version"'})]),_:1}),t(l,{title:"Maven","group-key":"maven"},{default:n(()=>[t(e,{lang:"XML",code:`               <dependency>
                   <groupId>io.ktor</groupId>
                   <artifactId>ktor-client-js-macosx64</artifactId>
                   <version>\${ktor_version}</version>
               </dependency>`})]),_:1})]),_:1})]),s[27]||(s[27]=p(`<li><p><code>Js</code>クラスを<code>HttpClient</code>コンストラクターの引数として渡します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.js.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Js)</span></span></code></pre></div><p><code>JsClient</code>関数を呼び出して、<code>Js</code>エンジンのシングルトンを取得することもできます。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.js.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> JsClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div></li>`,1))]),s[49]||(s[49]=p(`<p>完全な例は<a href="https://github.com/ktorio/ktor-documentation/tree/3.2.3/codeSnippets/snippets/client-engine-js" target="_blank" rel="noreferrer">client-engine-js</a>で見つけることができます。</p><h2 id="mpp-config" tabindex="-1">例: マルチプラットフォームモバイルプロジェクトでエンジンを構成する方法 <a class="header-anchor" href="#mpp-config" aria-label="Permalink to &quot;例: マルチプラットフォームモバイルプロジェクトでエンジンを構成する方法 {id=&quot;mpp-config&quot;}&quot;">​</a></h2><p>マルチプラットフォームモバイルプロジェクトでエンジン固有のオプションを構成するには、<a href="https://kotlinlang.org/docs/multiplatform-mobile-connect-to-platform-specific-apis.html" target="_blank" rel="noreferrer">expect/actual宣言</a>を使用できます。 <a href="./client-create-multiplatform-application">クロスプラットフォームモバイルアプリケーションの作成</a>チュートリアルで作成したプロジェクトを使用して、これを実現する方法を示します。</p><ol><li><p><code>shared/src/commonMain/kotlin/com/example/kmmktor/Platform.kt</code>ファイルを開き、クライアント構成を受け取り<code>HttpClient</code>を返すトップレベルの<code>httpClient</code>関数を追加します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">expect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> httpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HttpClientConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;*&gt;.() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Unit </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HttpClient</span></span></code></pre></div></li><li><p><code>shared/src/androidMain/kotlin/com/example/kmmktor/Platform.kt</code>を開き、Androidモジュール用の<code>httpClient</code>関数のactual宣言を追加します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.okhttp.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> java.util.concurrent.TimeUnit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">actual </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> httpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HttpClientConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;*&gt;.() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Unit) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(OkHttp) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         retryOnConnectionFailure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         connectTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, TimeUnit.SECONDS)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>この例では<a href="#okhttp">OkHttp</a>エンジンの構成方法を示していますが、<a href="#jvm-android">Androidでサポートされている</a>他のエンジンも使用できます。</p></li><li><p><code>shared/src/iosMain/kotlin/com/example/kmmktor/Platform.kt</code>を開き、iOSモジュール用の<code>httpClient</code>関数のactual宣言を追加します。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.engine.darwin.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">actual </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> httpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HttpClientConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;*&gt;.() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Unit) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Darwin) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      configureRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         setAllowsCellularAccess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p>最後に、<code>shared/src/commonMain/kotlin/com/example/kmmktor/Greeting.kt</code>を開き、<code>HttpClient()</code>コンストラクターを<code>httpClient</code>関数呼び出しに置き換えます。</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> httpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div></li></ol>`,4))])}const b=d(E,[["render",y]]);export{f as __pageData,b as default};
