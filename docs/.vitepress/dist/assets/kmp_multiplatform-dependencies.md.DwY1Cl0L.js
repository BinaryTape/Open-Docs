import{_ as h}from"./chunks/icon-1-done.B5D6C9SU.js";import{_ as k}from"./chunks/icon-2-done.e1N9yMQF.js";import{_ as o}from"./chunks/icon-3.DqpDG4W7.js";import{_ as d}from"./chunks/icon-4-todo.DqbNYzPe.js";import{_ as E}from"./chunks/icon-5-todo.DJgVODZv.js";import{_ as g}from"./chunks/gradle-sync.fCQp85Nh.js";import{_ as u}from"./chunks/first-multiplatform-project-3.DSsneMHX.js";import{_ as m,C as l,c as y,o as F,j as s,G as t,ag as f,a,w as n}from"./chunks/framework.Bksy39di.js";const T=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"kmp/multiplatform-dependencies.md","filePath":"kmp/multiplatform-dependencies.md","lastUpdated":1755516278000}'),c={name:"kmp/multiplatform-dependencies.md"};function C(b,i,B,A,D,v){const e=l("secondary-label"),p=l("Links"),r=l("tldr");return F(),y("div",null,[i[22]||(i[22]=s("h1",{id:"向项目添加依赖项",tabindex:"-1"},[a("向项目添加依赖项 "),s("a",{class:"header-anchor",href:"#向项目添加依赖项","aria-label":'Permalink to "向项目添加依赖项"'},"​")],-1)),t(e,{ref:"IntelliJ IDEA"},null,512),t(e,{ref:"Android Studio"},null,512),t(r,null,{default:n(()=>[i[18]||(i[18]=s("p",null,"本教程使用 IntelliJ IDEA，但你也可以在 Android Studio 中进行操作 —— 这两款 IDE 共享相同的核心功能和 Kotlin Multiplatform 支持。",-1)),i[19]||(i[19]=s("br",null,null,-1)),i[20]||(i[20]=s("br",null,null,-1)),i[21]||(i[21]=s("p",null,[a("这是"),s("strong",null,"使用共享逻辑和原生 UI 创建 Kotlin Multiplatform 应用"),a("教程的第三部分。在继续之前，请确保你已完成前述步骤。")],-1)),s("p",null,[i[2]||(i[2]=s("img",{src:h,width:"20",alt:"第一步"},null,-1)),i[3]||(i[3]=a()),t(p,{href:"/kmp/multiplatform-create-first-app",summary:"This tutorial uses IntelliJ IDEA, but you can also follow it in Android Studio – both IDEs share the same core functionality and Kotlin Multiplatform support. This is the first part of the Create a Kotlin Multiplatform app with shared logic and native UI tutorial. Create your Kotlin Multiplatform app Update the user interface Add dependencies Share more logic Wrap up your project"},{default:n(()=>i[0]||(i[0]=[a("创建你的 Kotlin Multiplatform 应用")])),_:1}),i[4]||(i[4]=s("br",null,null,-1)),i[5]||(i[5]=s("img",{src:k,width:"20",alt:"第二步"},null,-1)),i[6]||(i[6]=a()),t(p,{href:"/kmp/multiplatform-update-ui",summary:"This tutorial uses IntelliJ IDEA, but you can also follow it in Android Studio – both IDEs share the same core functionality and Kotlin Multiplatform support. This is the second part of the Create a Kotlin Multiplatform app with shared logic and native UI tutorial. Before proceeding, make sure you've completed previous steps. Create your Kotlin Multiplatform app Update the user interface Add dependencies Share more logic Wrap up your project"},{default:n(()=>i[1]||(i[1]=[a("更新用户界面")])),_:1}),i[7]||(i[7]=s("br",null,null,-1)),i[8]||(i[8]=s("img",{src:o,width:"20",alt:"第三步"},null,-1)),i[9]||(i[9]=a()),i[10]||(i[10]=s("strong",null,"添加依赖项",-1)),i[11]||(i[11]=s("br",null,null,-1)),i[12]||(i[12]=s("img",{src:d,width:"20",alt:"第四步"},null,-1)),i[13]||(i[13]=a(" 共享更多逻辑")),i[14]||(i[14]=s("br",null,null,-1)),i[15]||(i[15]=s("img",{src:E,width:"20",alt:"第五步"},null,-1)),i[16]||(i[16]=a(" 完成你的项目")),i[17]||(i[17]=s("br",null,null,-1))])]),_:1}),i[23]||(i[23]=f(`<p>你已经创建了第一个跨平台 Kotlin Multiplatform 项目！现在，让我们学习如何向第三方库添加依赖项，这对于构建成功的跨平台应用程序至关重要。</p><h2 id="依赖项类型" tabindex="-1">依赖项类型 <a class="header-anchor" href="#依赖项类型" aria-label="Permalink to &quot;依赖项类型&quot;">​</a></h2><p>在 Kotlin Multiplatform 项目中，你可以使用两种类型的依赖项：</p><ul><li><p><em>Multiplatform 依赖项</em>。这些是支持多个目标平台并可在公共源代码集 <code>commonMain</code> 中使用的 Multiplatform 库。</p><p>许多现代 Android 库已经支持 Multiplatform，例如 <a href="https://insert-koin.io/" target="_blank" rel="noreferrer">Koin</a>、<a href="https://www.apollographql.com/" target="_blank" rel="noreferrer">Apollo</a> 和 <a href="https://square.github.io/okio/" target="_blank" rel="noreferrer">Okio</a>。在 <a href="https://klibs.io/" target="_blank" rel="noreferrer">klibs.io</a> 上查找更多 Multiplatform 库，这是一个 JetBrains 提供的用于发现 Kotlin Multiplatform 库的实验性的搜索服务。</p></li><li><p><em>原生依赖项</em>。这些是来自相关生态系统的常规库。在原生项目中，你通常使用 Gradle（针对 Android）以及 CocoaPods 或其他依赖项管理器（针对 iOS）来处理它们。</p><p>当你使用共享模块时，通常当你想要使用平台 API（例如安全存储）时，仍然需要原生依赖项。你可以将原生依赖项添加到原生源代码集 <code>androidMain</code> 和 <code>iosMain</code> 中。</p></li></ul><p>对于这两种类型的依赖项，你可以使用本地和外部版本库。</p><h2 id="添加-multiplatform-依赖项" tabindex="-1">添加 Multiplatform 依赖项 <a class="header-anchor" href="#添加-multiplatform-依赖项" aria-label="Permalink to &quot;添加 Multiplatform 依赖项&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>如果你拥有 Android 应用开发经验，添加 Multiplatform 依赖项类似于在常规 Android 项目中添加 Gradle 依赖项。唯一的区别是你需要指定源代码集。</p></div><p>让我们回到应用，让问候语更喜庆一些。除了设备信息之外，再添加一个函数来显示距离元旦剩余的天数。<code>kotlinx-datetime</code> 库拥有完整的 Multiplatform 支持，是你在共享代码中处理日期最便捷的方式。</p><ol><li><p>打开位于 <code>shared</code> 目录下的 <code>build.gradle.kts</code> 文件。</p></li><li><p>将以下依赖项和 Kotlin 时间 opt-in 添加到 <code>commonMain</code> 源代码集依赖项中：</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kotlin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    //... </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sourceSets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        languageSettings.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">optIn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;kotlin.time.ExperimentalTime&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        commonMain.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            implementation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;org.jetbrains.kotlinx:kotlinx-datetime:0.7.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p>点击 <strong>Sync Gradle Changes</strong> 按钮来同步 Gradle 文件：<img src="`+g+`" alt="Synchronize Gradle files" width="50"></p></li><li><p>在 <code>shared/src/commonMain/kotlin</code> 中，在你的 <code>Greeting.kt</code> 文件所在的项目目录下创建一个新文件 <code>NewYear.kt</code>。</p></li><li><p>使用一个简短函数更新该文件，该函数使用 <code>date-time</code> 日期算术计算从今天到新年的天数：</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlinx.datetime.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlin.time.Clock</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> daysUntilNewYear</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> today </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Clock.System.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">todayIn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(TimeZone.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">currentSystemDefault</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> closestNewYear </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LocalDate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(today.year </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> today.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">daysUntil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(closestNewYear)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> daysPhrase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;There are only \${</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">daysUntilNewYear</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">()} days left until New Year! 🎆&quot;</span></span></code></pre></div></li><li><p>在 <code>Greeting.kt</code> 中，更新 <code>Greeting</code> 类以查看结果：</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Greeting</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> platform: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Platform</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getPlatform</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> greet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> buildList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Random.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nextBoolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Hi!&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> else</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Hello!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Guess what this is! &gt; \${platform.name.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">reversed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">()}!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">daysPhrase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p>要查看结果，请从 IntelliJ IDEA 重新运行你的 <strong>composeApp</strong> 和 <strong>iosApp</strong> 配置：</p></li></ol><p><img src="`+u+'" alt="Updated mobile multiplatform app with external dependencies" width="500"></p><h2 id="下一步" tabindex="-1">下一步 <a class="header-anchor" href="#下一步" aria-label="Permalink to &quot;下一步&quot;">​</a></h2><p>在教程的下一部分，你将为项目添加更多依赖项和更复杂的逻辑。</p><p><strong><a href="./multiplatform-upgrade-app">继续下一部分</a></strong></p><h3 id="另请参阅" tabindex="-1">另请参阅 <a class="header-anchor" href="#另请参阅" aria-label="Permalink to &quot;另请参阅&quot;">​</a></h3><ul><li>了解如何使用所有类型的 Multiplatform 依赖项：<a href="./multiplatform-add-dependencies">Kotlin 库、Kotlin Multiplatform 库以及其他 Multiplatform 项目</a>。</li><li>学习如何<a href="./multiplatform-android-dependencies">添加 Android 依赖项</a>以及<a href="./multiplatform-ios-dependencies">使用或不使用 CocoaPods 添加 iOS 依赖项</a>以在平台特有的源代码集中使用。</li><li>查看在示例项目中<a href="./multiplatform-samples">如何使用 Android 和 iOS 库</a>的示例。</li></ul><h2 id="获取帮助" tabindex="-1">获取帮助 <a class="header-anchor" href="#获取帮助" aria-label="Permalink to &quot;获取帮助&quot;">​</a></h2><ul><li><strong>Kotlin Slack</strong>。获取<a href="https://surveys.jetbrains.com/s3/kotlin-slack-sign-up" target="_blank" rel="noreferrer">邀请</a>并加入 <a href="https://kotlinlang.slack.com/archives/C3PQML5NU" target="_blank" rel="noreferrer">#multiplatform</a> 频道。</li><li><strong>Kotlin 问题追踪器</strong>。<a href="https://youtrack.jetbrains.com/newIssue?project=KT" target="_blank" rel="noreferrer">报告新问题</a>。</li></ul>',17))])}const N=m(c,[["render",C]]);export{T as __pageData,N as default};
