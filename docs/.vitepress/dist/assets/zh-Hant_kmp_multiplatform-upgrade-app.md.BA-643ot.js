import{_ as r}from"./chunks/icon-1-done.B5D6C9SU.js";import{_ as d}from"./chunks/icon-2-done.e1N9yMQF.js";import{_ as E}from"./chunks/icon-3-done.D86i6ZaO.js";import{_ as o}from"./chunks/icon-4.CODFcxoy.js";import{_ as g}from"./chunks/icon-5-todo.DJgVODZv.js";import{_ as c,a as y}from"./chunks/multiplatform-mobile-upgrade-ios.C-YVNNGz.js";import{_ as F,a as u}from"./chunks/multiplatform-add-package.DxcZA53w.js";import{_ as C,C as e,c as m,o as B,j as i,G as n,ag as p,a,w as l}from"./chunks/framework.Bksy39di.js";const I=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"zh-Hant/kmp/multiplatform-upgrade-app.md","filePath":"zh-Hant/kmp/multiplatform-upgrade-app.md","lastUpdated":1755516278000}'),b={name:"zh-Hant/kmp/multiplatform-upgrade-app.md"};function A(v,s,D,f,w,S){const h=e("secondary-label"),t=e("Links"),k=e("tldr");return B(),m("div",null,[s[22]||(s[22]=i("h1",{id:"åœ¨-ios-å’Œ-android-ä¹‹é–“åˆ†äº«æ›´å¤šé‚è¼¯",tabindex:"-1"},[a("åœ¨ iOS å’Œ Android ä¹‹é–“åˆ†äº«æ›´å¤šé‚è¼¯ "),i("a",{class:"header-anchor",href:"#åœ¨-ios-å’Œ-android-ä¹‹é–“åˆ†äº«æ›´å¤šé‚è¼¯","aria-label":'Permalink to "åœ¨ iOS å’Œ Android ä¹‹é–“åˆ†äº«æ›´å¤šé‚è¼¯"'},"â€‹")],-1)),n(h,{ref:"IntelliJ IDEA"},null,512),n(h,{ref:"Android Studio"},null,512),n(k,null,{default:l(()=>[s[19]||(s[19]=i("p",null,"æœ¬æ•™å­¸èª²ç¨‹ä½¿ç”¨ IntelliJ IDEAï¼Œä½†æ‚¨ä¹Ÿå¯ä»¥åœ¨ Android Studio ä¸­è·Ÿéš¨æ“ä½œ â€“ å…©å€‹ IDE éƒ½å…±äº«ç›¸åŒçš„æ ¸å¿ƒåŠŸèƒ½å’Œ Kotlin å¤šå¹³å°æ”¯æ´ã€‚",-1)),s[20]||(s[20]=i("br",null,null,-1)),s[21]||(s[21]=i("p",null,[a("é€™æ˜¯"),i("strong",null,"ä½¿ç”¨å…±äº«é‚è¼¯å’ŒåŸç”Ÿ UI å»ºç«‹ Kotlin å¤šå¹³å°æ‡‰ç”¨ç¨‹å¼"),a("æ•™å­¸èª²ç¨‹çš„ç¬¬å››éƒ¨åˆ†ã€‚åœ¨ç¹¼çºŒä¹‹å‰ï¼Œè«‹ç¢ºä¿æ‚¨å·²å®Œæˆå…ˆå‰çš„æ­¥é©Ÿã€‚")],-1)),i("p",null,[s[3]||(s[3]=i("img",{src:r,width:"20",alt:"First step"},null,-1)),s[4]||(s[4]=a()),n(t,{href:"/kmp/multiplatform-create-first-app",summary:"This tutorial uses IntelliJ IDEA, but you can also follow it in Android Studio â€“ both IDEs share the same core functionality and Kotlin Multiplatform support. This is the first part of the Create a Kotlin Multiplatform app with shared logic and native UI tutorial. Create your Kotlin Multiplatform app Update the user interface Add dependencies Share more logic Wrap up your project"},{default:l(()=>s[0]||(s[0]=[a("å»ºç«‹æ‚¨çš„ Kotlin å¤šå¹³å°æ‡‰ç”¨ç¨‹å¼")])),_:1}),s[5]||(s[5]=i("br",null,null,-1)),s[6]||(s[6]=i("img",{src:d,width:"20",alt:"Second step"},null,-1)),s[7]||(s[7]=a()),n(t,{href:"/kmp/multiplatform-update-ui",summary:"This tutorial uses IntelliJ IDEA, but you can also follow it in Android Studio â€“ both IDEs share the same core functionality and Kotlin Multiplatform support. This is the second part of the Create a Kotlin Multiplatform app with shared logic and native UI tutorial. Before proceeding, make sure you've completed previous steps. Create your Kotlin Multiplatform app Update the user interface Add dependencies Share more logic Wrap up your project"},{default:l(()=>s[1]||(s[1]=[a("æ›´æ–°ä½¿ç”¨è€…ä»‹é¢")])),_:1}),s[8]||(s[8]=i("br",null,null,-1)),s[9]||(s[9]=i("img",{src:E,width:"20",alt:"Third step"},null,-1)),s[10]||(s[10]=a()),n(t,{href:"/kmp/multiplatform-dependencies",summary:"This tutorial uses IntelliJ IDEA, but you can also follow it in Android Studio â€“ both IDEs share the same core functionality and Kotlin Multiplatform support. This is the third part of the Create a Kotlin Multiplatform app with shared logic and native UI tutorial. Before proceeding, make sure you've completed previous steps. Create your Kotlin Multiplatform app Update the user interface Add dependencies Share more logic Wrap up your project"},{default:l(()=>s[2]||(s[2]=[a("æ–°å¢ä¾è³´é …")])),_:1}),s[11]||(s[11]=i("br",null,null,-1)),s[12]||(s[12]=i("img",{src:o,width:"20",alt:"Fourth step"},null,-1)),s[13]||(s[13]=a()),s[14]||(s[14]=i("strong",null,"åˆ†äº«æ›´å¤šé‚è¼¯",-1)),s[15]||(s[15]=i("br",null,null,-1)),s[16]||(s[16]=i("img",{src:g,width:"20",alt:"Fifth step"},null,-1)),s[17]||(s[17]=a(" ç¸½çµæ‚¨çš„å°ˆæ¡ˆ")),s[18]||(s[18]=i("br",null,null,-1))])]),_:1}),s[23]||(s[23]=p(`<p>æ—¢ç„¶æ‚¨å·²ç¶“ä½¿ç”¨å¤–éƒ¨ä¾è³´é …å¯¦ç¾äº†é€šç”¨é‚è¼¯ï¼Œæ‚¨å°±å¯ä»¥é–‹å§‹æ·»åŠ æ›´è¤‡é›œçš„é‚è¼¯ã€‚ç¶²è·¯è«‹æ±‚å’Œè³‡æ–™åºåˆ—åŒ–æ˜¯ä½¿ç”¨ Kotlin å¤šå¹³å°å…±äº«ç¨‹å¼ç¢¼çš„<a href="https://kotlinlang.org/lp/multiplatform/" target="_blank" rel="noreferrer">æœ€å—æ­¡è¿ç”¨ä¾‹</a>ã€‚äº†è§£å¦‚ä½•åœ¨æ‚¨çš„ç¬¬ä¸€å€‹æ‡‰ç”¨ç¨‹å¼ä¸­å¯¦ç¾é€™äº›åŠŸèƒ½ï¼Œä»¥ä¾¿åœ¨å®Œæˆæ­¤å…¥é–€æ—…ç¨‹å¾Œï¼Œæ‚¨å¯ä»¥åœ¨æœªä¾†çš„å°ˆæ¡ˆä¸­ä½¿ç”¨å®ƒå€‘ã€‚</p><p>æ›´æ–°å¾Œçš„æ‡‰ç”¨ç¨‹å¼å°‡é€éç¶²è·¯å¾ <a href="https://github.com/r-spacex/SpaceX-API/tree/master/docs#rspacex-api-docs" target="_blank" rel="noreferrer">SpaceX API</a> æª¢ç´¢è³‡æ–™ï¼Œä¸¦é¡¯ç¤º SpaceX ç«ç®­ä¸Šæ¬¡æˆåŠŸç™¼å°„çš„æ—¥æœŸã€‚</p><div class="note custom-block"><p class="custom-block-title">NOTE</p><p>æ‚¨å¯ä»¥åœ¨æˆ‘å€‘çš„ GitHub å„²å­˜åº«çš„å…©å€‹åˆ†æ”¯ä¸­æ‰¾åˆ°å°ˆæ¡ˆçš„æœ€çµ‚ç‹€æ…‹ï¼Œå®ƒå€‘å…·æœ‰ä¸åŒçš„å”ç¨‹è§£æ±ºæ–¹æ¡ˆï¼š * <a href="https://github.com/kotlin-hands-on/get-started-with-kmp/tree/main" target="_blank" rel="noreferrer"><code>main</code></a> åˆ†æ”¯åŒ…å«ä¸€å€‹ KMP-NativeCoroutines å¯¦ç¾ï¼Œ * <a href="https://github.com/kotlin-hands-on/get-started-with-kmp/tree/main-skie" target="_blank" rel="noreferrer"><code>main-skie</code></a> åˆ†æ”¯åŒ…å«ä¸€å€‹ SKIE å¯¦ç¾ã€‚</p></div><h2 id="æ–°å¢æ›´å¤šä¾è³´é …" tabindex="-1">æ–°å¢æ›´å¤šä¾è³´é … <a class="header-anchor" href="#æ–°å¢æ›´å¤šä¾è³´é …" aria-label="Permalink to &quot;æ–°å¢æ›´å¤šä¾è³´é …&quot;">â€‹</a></h2><p>æ‚¨éœ€è¦åœ¨å°ˆæ¡ˆä¸­æ–°å¢ä»¥ä¸‹å¤šå¹³å°å‡½å¼åº«ï¼š</p><ul><li><a href="https://github.com/Kotlin/kotlinx.coroutines" target="_blank" rel="noreferrer"><code>kotlinx.coroutines</code></a>ï¼Œç”¨æ–¼ç•°æ­¥ç¨‹å¼ç¢¼çš„å”ç¨‹ï¼Œé€™å…è¨±åŒæ™‚æ“ä½œã€‚</li><li><a href="https://github.com/Kotlin/kotlinx.serialization" target="_blank" rel="noreferrer"><code>kotlinx.serialization</code></a>ï¼Œç”¨æ–¼å°‡ JSON éŸ¿æ‡‰ååºåˆ—åŒ–ç‚ºå¯¦é«”é¡åˆ¥çš„ç‰©ä»¶ï¼Œé€™äº›ç‰©ä»¶ç”¨æ–¼è™•ç†ç¶²è·¯æ“ä½œã€‚</li><li><a href="https://ktor.io/" target="_blank" rel="noreferrer">Ktor</a>ï¼Œä¸€å€‹ç”¨æ–¼å»ºç«‹ HTTP å®¢æˆ¶ç«¯ä»¥é€éç¶²è·¯æª¢ç´¢è³‡æ–™çš„æ¡†æ¶ã€‚</li></ul><h3 id="kotlinx-coroutines" tabindex="-1">kotlinx.coroutines <a class="header-anchor" href="#kotlinx-coroutines" aria-label="Permalink to &quot;kotlinx.coroutines&quot;">â€‹</a></h3><p>è‹¥è¦å°‡ <code>kotlinx.coroutines</code> åŠ å…¥åˆ°æ‚¨çš„å°ˆæ¡ˆï¼Œè«‹åœ¨é€šç”¨åŸå§‹ç¢¼é›†ä¸­æŒ‡å®šä¸€å€‹ä¾è³´é …ã€‚ç‚ºæ­¤ï¼Œè«‹å°‡ä»¥ä¸‹è¡Œæ–°å¢åˆ°å…±äº«æ¨¡çµ„çš„ <code>build.gradle.kts</code> æª”æ¡ˆä¸­ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kotlin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ... </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sourceSets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        commonMain.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           // ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">           implementation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;org.jetbrains.kotlinx:kotlinx-coroutines-core:1.10.2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>å¤šå¹³å° Gradle å¤–æ›ç¨‹å¼æœƒè‡ªå‹•å°‡ä¾è³´é …æ·»åŠ åˆ° <code>kotlinx.coroutines</code> çš„å¹³å°ç‰¹å®šï¼ˆiOS å’Œ Androidï¼‰éƒ¨åˆ†ã€‚</p><h3 id="kotlinx-serialization" tabindex="-1">kotlinx.serialization <a class="header-anchor" href="#kotlinx-serialization" aria-label="Permalink to &quot;kotlinx.serialization&quot;">â€‹</a></h3><p>è‹¥è¦ä½¿ç”¨ <code>kotlinx.serialization</code> å‡½å¼åº«ï¼Œè«‹è¨­å®šç›¸æ‡‰çš„ Gradle å¤–æ›ç¨‹å¼ã€‚ç‚ºæ­¤ï¼Œè«‹å°‡ä»¥ä¸‹è¡Œæ–°å¢åˆ°å…±äº«æ¨¡çµ„çš„ <code>build.gradle.kts</code> æª”æ¡ˆé–‹é ­çš„ç¾æœ‰ <code>plugins {}</code> å€å¡Šä¸­ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plugins</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    kotlin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;plugin.serialization&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) version </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2.2.0&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="ktor" tabindex="-1">Ktor <a class="header-anchor" href="#ktor" aria-label="Permalink to &quot;Ktor&quot;">â€‹</a></h3><p>æ‚¨éœ€è¦å°‡æ ¸å¿ƒä¾è³´é …ï¼ˆ<code>ktor-client-core</code>ï¼‰æ–°å¢åˆ°å…±äº«æ¨¡çµ„çš„é€šç”¨åŸå§‹ç¢¼é›†ã€‚ æ‚¨é‚„éœ€è¦æ–°å¢æ”¯æ´ä¾è³´é …ï¼š</p><ul><li>æ–°å¢ <code>ContentNegotiation</code> åŠŸèƒ½ï¼ˆ<code>ktor-client-content-negotiation</code>ï¼‰ï¼Œå®ƒå…è¨±ä»¥ç‰¹å®šæ ¼å¼åºåˆ—åŒ–å’Œååºåˆ—åŒ–å…§å®¹ã€‚</li><li>æ–°å¢ <code>ktor-serialization-kotlinx-json</code> ä¾è³´é …ï¼Œä»¥æŒ‡ç¤º Ktor ä½¿ç”¨ JSON æ ¼å¼ä¸¦å°‡ <code>kotlinx.serialization</code> ä½œç‚ºåºåˆ—åŒ–å‡½å¼åº«ã€‚Ktor å°‡é æœŸ JSON è³‡æ–™ä¸¦åœ¨æ¥æ”¶éŸ¿æ‡‰æ™‚å°‡å…¶ååºåˆ—åŒ–ç‚ºè³‡æ–™é¡åˆ¥ã€‚</li><li>é€éåœ¨å¹³å°åŸå§‹ç¢¼é›†ä¸­æ–°å¢ç›¸æ‡‰çš„ artifact ä¾è³´é …ï¼ˆ<code>ktor-client-android</code>ã€<code>ktor-client-darwin</code>ï¼‰ä¾†æä¾›å¹³å°å¼•æ“ã€‚</li></ul><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kotlin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ktorVersion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;3.2.3&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sourceSets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        commonMain.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            implementation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;io.ktor:ktor-client-core:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$ktorVersion</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            implementation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;io.ktor:ktor-client-content-negotiation:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$ktorVersion</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            implementation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;io.ktor:ktor-serialization-kotlinx-json:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$ktorVersion</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        androidMain.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            implementation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;io.ktor:ktor-client-android:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$ktorVersion</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        iosMain.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            implementation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;io.ktor:ktor-client-darwin:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$ktorVersion</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>é»æ“Š<strong>åŒæ­¥ Gradle è®Šæ›´</strong>æŒ‰éˆ•ä»¥åŒæ­¥ Gradle æª”æ¡ˆã€‚</p><h2 id="å»ºç«‹-api-è«‹æ±‚" tabindex="-1">å»ºç«‹ API è«‹æ±‚ <a class="header-anchor" href="#å»ºç«‹-api-è«‹æ±‚" aria-label="Permalink to &quot;å»ºç«‹ API è«‹æ±‚&quot;">â€‹</a></h2><p>æ‚¨å°‡éœ€è¦ <a href="https://github.com/r-spacex/SpaceX-API/tree/master/docs#rspacex-api-docs" target="_blank" rel="noreferrer">SpaceX API</a> ä¾†æª¢ç´¢è³‡æ–™ï¼Œæ‚¨å°‡ä½¿ç”¨å–®ä¸€æ–¹æ³•å¾ <strong>v4/launches</strong> ç«¯é»ç²å–æ‰€æœ‰ç™¼å°„åˆ—è¡¨ã€‚</p><h3 id="æ–°å¢è³‡æ–™æ¨¡å‹" tabindex="-1">æ–°å¢è³‡æ–™æ¨¡å‹ <a class="header-anchor" href="#æ–°å¢è³‡æ–™æ¨¡å‹" aria-label="Permalink to &quot;æ–°å¢è³‡æ–™æ¨¡å‹&quot;">â€‹</a></h3><p>åœ¨ <code>shared/src/commonMain/kotlin/.../greetingkmp</code> ç›®éŒ„ä¸­ï¼Œå»ºç«‹ä¸€å€‹æ–°çš„ <code>RocketLaunch.kt</code> æª”æ¡ˆï¼Œä¸¦æ–°å¢ä¸€å€‹è³‡æ–™é¡åˆ¥ï¼Œè©²é¡åˆ¥å„²å­˜ä¾†è‡ª SpaceX API çš„è³‡æ–™ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlinx.serialization.SerialName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlinx.serialization.Serializable</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@Serializable</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RocketLaunch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    @SerialName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;flight_number&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> flightNumber: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    @SerialName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> missionName: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    @SerialName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;date_utc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> launchDateUTC: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    @SerialName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> launchSuccess: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">?,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><ul><li><code>RocketLaunch</code> é¡åˆ¥æ¨™è¨˜äº† <code>@Serializable</code> è¨»è§£ï¼Œä»¥ä¾¿ <code>kotlinx.serialization</code> å¤–æ›ç¨‹å¼å¯ä»¥è‡ªå‹•ç‚ºå…¶ç”Ÿæˆé è¨­åºåˆ—åŒ–å™¨ã€‚</li><li><code>@SerialName</code> è¨»è§£å…è¨±æ‚¨é‡æ–°å®šç¾©æ¬„ä½åç¨±ï¼Œå¾è€Œå¯ä»¥åœ¨è³‡æ–™é¡åˆ¥ä¸­å®£å‘Šæ›´å…·å¯è®€æ€§çš„å±¬æ€§ã€‚</li></ul><h3 id="é€£æ¥-http-å®¢æˆ¶ç«¯" tabindex="-1">é€£æ¥ HTTP å®¢æˆ¶ç«¯ <a class="header-anchor" href="#é€£æ¥-http-å®¢æˆ¶ç«¯" aria-label="Permalink to &quot;é€£æ¥ HTTP å®¢æˆ¶ç«¯&quot;">â€‹</a></h3><ol><li><p>åœ¨ <code>shared/src/commonMain/kotlin/.../greetingkmp</code> ç›®éŒ„ä¸­ï¼Œå»ºç«‹ä¸€å€‹æ–°çš„ <code>RocketComponent</code> é¡åˆ¥ã€‚</p></li><li><p>æ–°å¢ <code>httpClient</code> å±¬æ€§ï¼Œä»¥é€é HTTP GET è«‹æ±‚æª¢ç´¢ç«ç®­ç™¼å°„è³‡è¨Šï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.plugins.contentnegotiation.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.serialization.kotlinx.json.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlinx.serialization.json.Json</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RocketComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> httpClient </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        install</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ContentNegotiation) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                prettyPrint </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                isLenient </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                ignoreUnknownKeys </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><a href="https://ktor.io/docs/serialization-client.html#register_json" target="_blank" rel="noreferrer">ContentNegotiation Ktor å¤–æ›ç¨‹å¼</a> å’Œ JSON åºåˆ—åŒ–å™¨æœƒååºåˆ—åŒ– GET è«‹æ±‚çš„çµæœã€‚</li><li>é€™è£¡çš„ JSON åºåˆ—åŒ–å™¨é…ç½®ç‚ºä½¿ç”¨ <code>prettyPrint</code> å±¬æ€§ä»¥æ›´å…·å¯è®€æ€§çš„æ–¹å¼åˆ—å° JSONã€‚å®ƒåœ¨è®€å–æ ¼å¼éŒ¯èª¤çš„ JSON æ™‚ä½¿ç”¨ <code>isLenient</code> æ›´å…·å½ˆæ€§ï¼Œä¸¦ä¸”ä½¿ç”¨ <code>ignoreUnknownKeys</code> å¿½ç•¥æœªåœ¨ç«ç®­ç™¼å°„æ¨¡å‹ä¸­å®£å‘Šçš„éµã€‚</li></ul></li><li><p>å°‡ <code>getDateOfLastSuccessfulLaunch()</code> æš«åœå‡½å¼æ–°å¢åˆ° <code>RocketComponent</code>ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RocketComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> suspend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getDateOfLastSuccessfulLaunch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p>å‘¼å« <code>httpClient.get()</code> å‡½å¼ä»¥æª¢ç´¢æœ‰é—œç«ç®­ç™¼å°„çš„è³‡è¨Šï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.request.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> io.ktor.client.call.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RocketComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> suspend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getDateOfLastSuccessfulLaunch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rockets: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RocketLaunch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> httpClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://api.spacexdata.com/v4/launches&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>httpClient.get()</code> ä¹Ÿæ˜¯ä¸€å€‹æš«åœå‡½å¼ï¼Œå› ç‚ºå®ƒéœ€è¦ç•°æ­¥åœ°é€éç¶²è·¯æª¢ç´¢è³‡æ–™è€Œä¸æœƒé˜»å¡åŸ·è¡Œç·’ã€‚</li><li>æš«åœå‡½å¼åªèƒ½å¾å”ç¨‹æˆ–å…¶ä»–æš«åœå‡½å¼ä¸­å‘¼å«ã€‚é€™å°±æ˜¯ç‚ºä»€éº¼ <code>getDateOfLastSuccessfulLaunch()</code> è¢«æ¨™è¨˜ç‚º <code>suspend</code> é—œéµå­—ã€‚ç¶²è·¯è«‹æ±‚åœ¨ HTTP å®¢æˆ¶ç«¯çš„åŸ·è¡Œç·’æ± ä¸­åŸ·è¡Œã€‚</li></ul></li><li><p>å†æ¬¡æ›´æ–°å‡½å¼ä»¥åœ¨åˆ—è¡¨ä¸­æ‰¾åˆ°æœ€å¾Œä¸€æ¬¡æˆåŠŸç™¼å°„ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RocketComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> suspend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getDateOfLastSuccessfulLaunch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rockets: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RocketLaunch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> httpClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://api.spacexdata.com/v4/launches&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lastSuccessLaunch </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rockets.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">last</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { it.launchSuccess </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>ç«ç®­ç™¼å°„åˆ—è¡¨æŒ‰æ—¥æœŸå¾æœ€èˆŠåˆ°æœ€æ–°æ’åºã€‚</p></li><li><p>å°‡ç™¼å°„æ—¥æœŸå¾ UTC è½‰æ›ç‚ºæ‚¨çš„æœ¬åœ°æ—¥æœŸä¸¦æ ¼å¼åŒ–è¼¸å‡ºï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlinx.datetime.TimeZone</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlinx.datetime.toLocalDateTime</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlin.time.Instant</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RocketComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> suspend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getDateOfLastSuccessfulLaunch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rockets: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RocketLaunch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            httpClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://api.spacexdata.com/v4/launches&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lastSuccessLaunch </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rockets.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">last</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { it.launchSuccess </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> date </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Instant.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lastSuccessLaunch.launchDateUTC)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toLocalDateTime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(TimeZone.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">currentSystemDefault</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\${date.month} \${date.day}, \${date.year}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>æ—¥æœŸå°‡æ¡ç”¨ã€ŒMMMM DD, YYYYã€æ ¼å¼ï¼Œä¾‹å¦‚ OCTOBER 5, 2022ã€‚</p></li><li><p>æ–°å¢å¦ä¸€å€‹æš«åœå‡½å¼ <code>launchPhrase()</code>ï¼Œå®ƒå°‡ä½¿ç”¨ <code>getDateOfLastSuccessfulLaunch()</code> å‡½å¼å»ºç«‹ä¸€æ¢è¨Šæ¯ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RocketComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    suspend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> launchPhrase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;The last successful launch was on \${</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getDateOfLastSuccessfulLaunch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">()} ğŸš€&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (e: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Exception</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Exception during getting the date of the last successful launch </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;Error occurred&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ol><h3 id="å»ºç«‹-flow" tabindex="-1">å»ºç«‹ Flow <a class="header-anchor" href="#å»ºç«‹-flow" aria-label="Permalink to &quot;å»ºç«‹ Flow&quot;">â€‹</a></h3><p>æ‚¨å¯ä»¥ä½¿ç”¨ Flow è€Œä¸æ˜¯æš«åœå‡½å¼ã€‚å®ƒå€‘ç™¼å‡ºä¸€ç³»åˆ—å€¼ï¼Œè€Œä¸æ˜¯æš«åœå‡½å¼è¿”å›çš„å–®å€‹å€¼ã€‚</p><ol><li><p>åœ¨ <code>shared/src/commonMain/kotlin</code> ç›®éŒ„ä¸­é–‹å•Ÿ <code>Greeting.kt</code> æª”æ¡ˆã€‚</p></li><li><p>ç‚º <code>Greeting</code> é¡åˆ¥æ–°å¢ <code>rocketComponent</code> å±¬æ€§ã€‚è©²å±¬æ€§å°‡å„²å­˜åŒ…å«æœ€å¾Œä¸€æ¬¡æˆåŠŸç™¼å°„æ—¥æœŸçš„è¨Šæ¯ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rocketComponent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RocketComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div></li><li><p>å°‡ <code>greet()</code> å‡½å¼æ›´æ”¹ç‚ºè¿”å›ä¸€å€‹ <code>Flow</code>ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlinx.coroutines.delay</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlinx.coroutines.flow.Flow</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlinx.coroutines.flow.flow</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlin.time.Duration.Companion.seconds</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Greeting</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> greet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Flow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> flow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        emit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Random.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nextBoolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Hi!&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> else</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Hello!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        delay</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.seconds)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        emit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Guess what this is! &gt; \${platform.name.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">reversed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">()}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        delay</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.seconds)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        emit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">daysPhrase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        emit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rocketComponent.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">launchPhrase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li>é€™è£¡ä½¿ç”¨ <code>flow()</code> æ§‹å»ºå™¨å‡½å¼å»ºç«‹ <code>Flow</code>ï¼Œå®ƒåŒ…è£äº†æ‰€æœ‰èªå¥ã€‚</li><li><code>Flow</code> ä»¥ä¸€ç§’çš„å»¶é²ç™¼å‡ºå­—ä¸²ï¼Œæ¯å€‹ç™¼å‡ºä¹‹é–“é–“éš”ä¸€ç§’ã€‚æœ€å¾Œä¸€å€‹å…ƒç´ åƒ…åœ¨ç¶²è·¯éŸ¿æ‡‰è¿”å›å¾Œæ‰ç™¼å‡ºï¼Œå› æ­¤ç¢ºåˆ‡çš„å»¶é²å–æ±ºæ–¼æ‚¨çš„ç¶²è·¯ã€‚</li></ul></li></ol><h3 id="æ–°å¢ç¶²éš›ç¶²è·¯å­˜å–æ¬Šé™" tabindex="-1">æ–°å¢ç¶²éš›ç¶²è·¯å­˜å–æ¬Šé™ <a class="header-anchor" href="#æ–°å¢ç¶²éš›ç¶²è·¯å­˜å–æ¬Šé™" aria-label="Permalink to &quot;æ–°å¢ç¶²éš›ç¶²è·¯å­˜å–æ¬Šé™&quot;">â€‹</a></h3><p>è‹¥è¦å­˜å–ç¶²éš›ç¶²è·¯ï¼ŒAndroid æ‡‰ç”¨ç¨‹å¼éœ€è¦é©ç•¶çš„æ¬Šé™ã€‚ç”±æ–¼æ‰€æœ‰ç¶²è·¯è«‹æ±‚éƒ½ä¾†è‡ªå…±äº«æ¨¡çµ„ï¼Œå› æ­¤å°‡ç¶²éš›ç¶²è·¯å­˜å–æ¬Šé™æ–°å¢åˆ°å…¶è³‡è¨Šæ¸…å–®ä¸­æ˜¯åˆç†çš„ã€‚</p><p>ä½¿ç”¨å­˜å–æ¬Šé™æ›´æ–°æ‚¨çš„ <code>composeApp/src/androidMain/AndroidManifest.xml</code> æª”æ¡ˆï¼š</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;?</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">xml</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.0&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> encoding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;utf-8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">manifest</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:android</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://schemas.android.com/apk/res/android&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uses-permission</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> android:name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;android.permission.INTERNET&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">manifest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>æ‚¨å·²ç¶“é€éå°‡ <code>greet()</code> å‡½å¼çš„è¿”å›é¡å‹æ›´æ”¹ç‚º <code>Flow</code> ä¾†æ›´æ–°äº†å…±äº«æ¨¡çµ„çš„ APIã€‚ç¾åœ¨æ‚¨éœ€è¦æ›´æ–°å°ˆæ¡ˆçš„åŸç”Ÿéƒ¨åˆ†ï¼Œä»¥ä¾¿å®ƒå€‘å¯ä»¥æ­£ç¢ºè™•ç†å‘¼å« <code>greet()</code> å‡½å¼çš„çµæœã€‚</p><h2 id="æ›´æ–°åŸç”Ÿ-android-ui" tabindex="-1">æ›´æ–°åŸç”Ÿ Android UI <a class="header-anchor" href="#æ›´æ–°åŸç”Ÿ-android-ui" aria-label="Permalink to &quot;æ›´æ–°åŸç”Ÿ Android UI&quot;">â€‹</a></h2><p>ç”±æ–¼å…±äº«æ¨¡çµ„å’Œ Android æ‡‰ç”¨ç¨‹å¼éƒ½ç”¨ Kotlin ç·¨å¯«ï¼Œå› æ­¤å¾ Android ä½¿ç”¨å…±äº«ç¨‹å¼ç¢¼éå¸¸ç°¡å–®ã€‚</p><h3 id="å¼•å…¥è¦–åœ–æ¨¡å‹" tabindex="-1">å¼•å…¥è¦–åœ–æ¨¡å‹ <a class="header-anchor" href="#å¼•å…¥è¦–åœ–æ¨¡å‹" aria-label="Permalink to &quot;å¼•å…¥è¦–åœ–æ¨¡å‹&quot;">â€‹</a></h3><p>ç¾åœ¨æ‡‰ç”¨ç¨‹å¼è®Šå¾—æ›´è¤‡é›œäº†ï¼Œæ˜¯æ™‚å€™å‘åç‚º <code>MainActivity</code> çš„ <a href="https://developer.android.com/guide/components/activities/intro-activities" target="_blank" rel="noreferrer">Android activity</a> å¼•å…¥ä¸€å€‹è¦–åœ–æ¨¡å‹äº†ã€‚å®ƒå‘¼å«å¯¦ç¾ UI çš„ <code>App()</code> å‡½å¼ã€‚è¦–åœ–æ¨¡å‹å°‡ç®¡ç†ä¾†è‡ª activity çš„è³‡æ–™ï¼Œä¸¦ä¸”åœ¨ activity ç¶“æ­·ç”Ÿå‘½é€±æœŸæ›´æ”¹æ™‚ä¸æœƒæ¶ˆå¤±ã€‚</p><ol><li><p>å°‡ä»¥ä¸‹ä¾è³´é …æ–°å¢åˆ°æ‚¨çš„ <code>composeApp/build.gradle.kts</code> æª”æ¡ˆä¸­ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">androidMain.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    implementation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;androidx.lifecycle:lifecycle-viewmodel-ktx:2.6.2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    implementation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;androidx.lifecycle:lifecycle-runtime-compose:2.6.2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    implementation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;androidx.lifecycle:lifecycle-viewmodel-compose:2.6.2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p>åœ¨ <code>composeApp/src/androidMain/kotlin/com/jetbrains/greeting/greetingkmp</code> ç›®éŒ„ä¸­ï¼Œå»ºç«‹ä¸€å€‹æ–°çš„ <code>MainViewModel</code> Kotlin é¡åˆ¥ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> androidx.lifecycle.ViewModel</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MainViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>æ­¤é¡åˆ¥æ“´å±•äº† Android çš„ <code>ViewModel</code> é¡åˆ¥ï¼Œé€™ç¢ºä¿äº†é—œæ–¼ç”Ÿå‘½é€±æœŸå’Œé…ç½®æ›´æ”¹çš„æ­£ç¢ºè¡Œç‚ºã€‚</p></li><li><p>å»ºç«‹ä¸€å€‹ <a href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines.flow/-state-flow/" target="_blank" rel="noreferrer">StateFlow</a> é¡å‹çš„ <code>greetingList</code> å€¼åŠå…¶æ”¯æ´å±¬æ€§ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlinx.coroutines.flow.MutableStateFlow</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlinx.coroutines.flow.StateFlow</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MainViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _greetingList </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MutableStateFlow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">listOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> greetingList: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">StateFlow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _greetingList</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li>é€™è£¡çš„ <code>StateFlow</code> æ“´å±•äº† <code>Flow</code> ä»‹é¢ï¼Œä½†å®ƒåªæœ‰ä¸€å€‹å–®ä¸€å€¼æˆ–ç‹€æ…‹ã€‚</li><li>ç§æœ‰æ”¯æ´å±¬æ€§ <code>_greetingList</code> ç¢ºä¿åªæœ‰æ­¤é¡åˆ¥çš„å®¢æˆ¶ç«¯æ‰èƒ½å­˜å–å”¯è®€çš„ <code>greetingList</code> å±¬æ€§ã€‚</li></ul></li><li><p>åœ¨è¦–åœ–æ¨¡å‹çš„ <code>init</code> å‡½å¼ä¸­ï¼Œå¾ <code>Greeting().greet()</code> Flow ä¸­æ”¶é›†æ‰€æœ‰å­—ä¸²ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> androidx.lifecycle.viewModelScope</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlinx.coroutines.launch</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MainViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _greetingList </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MutableStateFlow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">listOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> greetingList: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">StateFlow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _greetingList</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       viewModelScope.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">launch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">           Greeting</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">greet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">collect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { phrase </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                //...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">           }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>ç”±æ–¼ <code>collect()</code> å‡½å¼æ˜¯æš«åœçš„ï¼Œå› æ­¤ <code>launch</code> å”ç¨‹åœ¨è¦–åœ–æ¨¡å‹çš„ç¯„åœå…§ä½¿ç”¨ã€‚é€™è¡¨ç¤º launch å”ç¨‹åªæœƒåœ¨è¦–åœ–æ¨¡å‹ç”Ÿå‘½é€±æœŸçš„æ­£ç¢ºéšæ®µåŸ·è¡Œã€‚</p></li><li><p>åœ¨ <code>collect</code> trailing lambda å…§éƒ¨ï¼Œæ›´æ–° <code>_greetingList</code> çš„å€¼ï¼Œå°‡æ”¶é›†åˆ°çš„ <code>phrase</code> é™„åŠ åˆ° <code>list</code> ä¸­çš„ç‰‡èªåˆ—è¡¨ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kotlinx.coroutines.flow.update</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MainViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    //...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        viewModelScope.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">launch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            Greeting</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">greet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">collect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { phrase </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                _greetingList.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> phrase }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><code>update()</code> å‡½å¼å°‡è‡ªå‹•æ›´æ–°å€¼ã€‚</p></li></ol><h3 id="ä½¿ç”¨è¦–åœ–æ¨¡å‹çš„-flow" tabindex="-1">ä½¿ç”¨è¦–åœ–æ¨¡å‹çš„ Flow <a class="header-anchor" href="#ä½¿ç”¨è¦–åœ–æ¨¡å‹çš„-flow" aria-label="Permalink to &quot;ä½¿ç”¨è¦–åœ–æ¨¡å‹çš„ Flow&quot;">â€‹</a></h3><ol><li><p>åœ¨ <code>composeApp/src/androidMain/kotlin</code> ä¸­ï¼Œé–‹å•Ÿ <code>App.kt</code> æª”æ¡ˆä¸¦æ›´æ–°å®ƒï¼Œæ›¿æ›å…ˆå‰çš„å¯¦ç¾ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> androidx.lifecycle.compose.collectAsStateWithLifecycle</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> androidx.compose.runtime.getValue</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> androidx.lifecycle.viewmodel.compose.viewModel</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@Composable</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> App</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mainViewModel: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MainViewModel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> viewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    MaterialTheme</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> greetings </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mainViewModel.greetingList.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">collectAsStateWithLifecycle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        Column</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            modifier </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Modifier</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">safeContentPadding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fillMaxSize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            verticalArrangement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Arrangement.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">spacedBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.dp),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            greetings.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { greeting </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                Text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(greeting)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                HorizontalDivider</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>collectAsStateWithLifecycle()</code> å‡½å¼å‘¼å« <code>greetingList</code>ï¼Œä»¥å¾ ViewModel çš„ Flow ä¸­æ”¶é›†å€¼ï¼Œä¸¦ä»¥èªçŸ¥ç”Ÿå‘½é€±æœŸçš„æ–¹å¼å°‡å…¶è¡¨ç¤ºç‚ºå¯çµ„åˆç‹€æ…‹ã€‚</li><li>ç•¶å»ºç«‹æ–°çš„ Flow æ™‚ï¼Œçµ„åˆç‹€æ…‹å°‡æœƒæ”¹è®Šï¼Œä¸¦é¡¯ç¤ºä¸€å€‹å¯æ»¾å‹•çš„ <code>Column</code>ï¼Œå…¶ä¸­åŒ…å«å‚ç›´æ’åˆ—ä¸¦ç”±åˆ†éš”ç·šåˆ†éš”çš„å•å€™ç‰‡èªã€‚</li></ul></li><li><p>è¦æŸ¥çœ‹çµæœï¼Œè«‹é‡æ–°åŸ·è¡Œæ‚¨çš„ <strong>composeApp</strong> é…ç½®ï¼š</p><p><img src="`+c+`" alt="Final results" width="300"></p></li></ol><h2 id="æ›´æ–°åŸç”Ÿ-ios-ui" tabindex="-1">æ›´æ–°åŸç”Ÿ iOS UI <a class="header-anchor" href="#æ›´æ–°åŸç”Ÿ-ios-ui" aria-label="Permalink to &quot;æ›´æ–°åŸç”Ÿ iOS UI&quot;">â€‹</a></h2><p>å°æ–¼å°ˆæ¡ˆçš„ iOS éƒ¨åˆ†ï¼Œæ‚¨å°‡å†æ¬¡åˆ©ç”¨ <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel" target="_blank" rel="noreferrer">æ¨¡å‹-è¦–åœ–-è¦–åœ–æ¨¡å‹ (Modelâ€“viewâ€“viewmodel)</a> æ¨¡å¼å°‡ UI é€£æ¥åˆ°åŒ…å«æ‰€æœ‰æ¥­å‹™é‚è¼¯çš„å…±äº«æ¨¡çµ„ã€‚</p><p>è©²æ¨¡çµ„å·²åœ¨ <code>ContentView.swift</code> æª”æ¡ˆä¸­é€é <code>import Shared</code> å®£å‘Šå°å…¥ã€‚</p><h3 id="å¼•å…¥-viewmodel" tabindex="-1">å¼•å…¥ ViewModel <a class="header-anchor" href="#å¼•å…¥-viewmodel" aria-label="Permalink to &quot;å¼•å…¥ ViewModel&quot;">â€‹</a></h3><p>åœ¨ <code>iosApp/ContentView.swift</code> ä¸­ï¼Œç‚º <code>ContentView</code> å»ºç«‹ä¸€å€‹ <code>ViewModel</code> é¡åˆ¥ï¼Œå®ƒå°‡ç‚ºå…¶æº–å‚™å’Œç®¡ç†è³‡æ–™ã€‚åœ¨ <code>task()</code> å‘¼å«ä¸­å‘¼å« <code>startObserving()</code> å‡½å¼ä»¥æ”¯æ´ä¸¦ç™¼ï¼š</p><div class="language-swift vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SwiftUI</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Shared</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ContentView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">View </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    @ObservedObject</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> private</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> viewModel: ViewModel</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> body: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> View {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        ListView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">phrases</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: viewModel.greetings)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">task</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.viewModel.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">startObserving</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">extension</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ContentView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    @MainActor</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ObservableObject </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        @Published</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> greetings: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> startObserving</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ListView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">View </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> phrases: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> body: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> View {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(phrases, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: \\.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            Text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>ViewModel</code> è¢«å®£å‘Šç‚º <code>ContentView</code> çš„æ“´å±•ï¼Œå› ç‚ºå®ƒå€‘ç·Šå¯†ç›¸é—œã€‚</li><li><code>ViewModel</code> æœ‰ä¸€å€‹ <code>greetings</code> å±¬æ€§ï¼Œå®ƒæ˜¯ä¸€å€‹ <code>String</code> ç‰‡èªçš„é™£åˆ—ã€‚SwiftUI å°‡ ViewModelï¼ˆ<code>ContentView.ViewModel</code>ï¼‰èˆ‡è¦–åœ–ï¼ˆ<code>ContentView</code>ï¼‰é€£æ¥èµ·ä¾†ã€‚</li><li><code>ContentView.ViewModel</code> è¢«å®£å‘Šç‚º <code>ObservableObject</code>ã€‚</li><li><code>@Published</code> åŒ…è£å™¨ç”¨æ–¼ <code>greetings</code> å±¬æ€§ã€‚</li><li><code>@ObservedObject</code> å±¬æ€§åŒ…è£å™¨ç”¨æ–¼è¨‚é–± ViewModelã€‚</li></ul><p>ç•¶æ­¤å±¬æ€§æ›´æ”¹æ™‚ï¼Œæ­¤ ViewModel å°‡ç™¼å‡ºè¨Šè™Ÿã€‚ç¾åœ¨æ‚¨éœ€è¦å¯¦ç¾ <code>startObserving()</code> å‡½å¼ä¾†æ¶ˆè²» Flowã€‚</p><h3 id="é¸æ“‡å‡½å¼åº«ä»¥å¾-ios-æ¶ˆè²»-flow" tabindex="-1">é¸æ“‡å‡½å¼åº«ä»¥å¾ iOS æ¶ˆè²» Flow <a class="header-anchor" href="#é¸æ“‡å‡½å¼åº«ä»¥å¾-ios-æ¶ˆè²»-flow" aria-label="Permalink to &quot;é¸æ“‡å‡½å¼åº«ä»¥å¾ iOS æ¶ˆè²» Flow&quot;">â€‹</a></h3><p>åœ¨æœ¬æ•™å­¸èª²ç¨‹ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <a href="https://skie.touchlab.co/" target="_blank" rel="noreferrer">SKIE</a> å’Œ <a href="https://github.com/rickclephas/KMP-NativeCoroutines" target="_blank" rel="noreferrer">KMP-NativeCoroutines</a> å‡½å¼åº«ä¾†å¹«åŠ©æ‚¨åœ¨ iOS ä¸­ä½¿ç”¨ Flowã€‚å…©è€…éƒ½æ˜¯é–‹æºè§£æ±ºæ–¹æ¡ˆï¼Œæ”¯æ´ Flow çš„å–æ¶ˆå’Œæ³›å‹ï¼Œè€Œ Kotlin/Native ç·¨è­¯å™¨ç›®å‰ä¸æä¾›é€™äº›åŠŸèƒ½ï¼š</p><ul><li>SKIE å‡½å¼åº«æ“´å±•äº† Kotlin ç·¨è­¯å™¨ç”Ÿæˆçš„ Objective-C APIï¼šSKIE å°‡ Flow è½‰æ›ç‚ºç­‰æ•ˆæ–¼ Swift çš„ <code>AsyncSequence</code>ã€‚SKIE ç›´æ¥æ”¯æ´ Swift çš„ <code>async</code>/<code>await</code>ï¼Œæ²’æœ‰åŸ·è¡Œç·’é™åˆ¶ï¼Œä¸¦å…·æœ‰è‡ªå‹•é›™å‘å–æ¶ˆåŠŸèƒ½ï¼ˆCombine å’Œ RxSwift éœ€è¦é©é…å™¨ï¼‰ã€‚SKIE é‚„æä¾›å…¶ä»–åŠŸèƒ½ï¼Œå¯å¾ Kotlin ç”Ÿæˆ Swift å‹å–„çš„ APIï¼ŒåŒ…æ‹¬å°‡å„ç¨® Kotlin é¡å‹æ©‹æ¥åˆ° Swift ç­‰æ•ˆé¡å‹ã€‚å®ƒä¹Ÿä¸éœ€è¦åœ¨ iOS å°ˆæ¡ˆä¸­æ·»åŠ é¡å¤–çš„ä¾è³´é …ã€‚</li><li>KMP-NativeCoroutines å‡½å¼åº«é€éç”Ÿæˆå¿…è¦çš„åŒ…è£å™¨ä¾†å¹«åŠ©æ‚¨å¾ iOS æ¶ˆè²»æš«åœå‡½å¼å’Œ Flowã€‚KMP-NativeCoroutines æ”¯æ´ Swift çš„ <code>async</code>/<code>await</code> åŠŸèƒ½ä»¥åŠ Combine å’Œ RxSwiftã€‚ä½¿ç”¨ KMP-NativeCoroutines éœ€è¦åœ¨ iOS å°ˆæ¡ˆä¸­æ·»åŠ  SPM æˆ– CocoaPod ä¾è³´é …ã€‚</li></ul>`,52)),s[24]||(s[24]=i("h3",{"initial-collapse-state":"collapsed",collapsible:"true",id:"é¸é …-1-é…ç½®-kmp-nativecoroutines",tabindex:"-1"},[a("é¸é … 1. é…ç½® KMP-NativeCoroutines "),i("a",{class:"header-anchor",href:"#é¸é …-1-é…ç½®-kmp-nativecoroutines","aria-label":'Permalink to "é¸é … 1. é…ç½® KMP-NativeCoroutines {initial-collapse-state="collapsed" collapsible="true"}"'},"â€‹")],-1)),s[25]||(s[25]=p(`<div class="note custom-block"><p class="custom-block-title">NOTE</p><p>æˆ‘å€‘å»ºè­°ä½¿ç”¨å‡½å¼åº«çš„æœ€æ–°ç‰ˆæœ¬ã€‚ è«‹æŸ¥çœ‹ <a href="https://github.com/rickclephas/KMP-NativeCoroutines/releases" target="_blank" rel="noreferrer">KMP-NativeCoroutines å„²å­˜åº«</a> ä»¥äº†è§£æ˜¯å¦æœ‰æ›´æ–°ç‰ˆæœ¬çš„å¤–æ›ç¨‹å¼å¯ç”¨ã€‚</p></div><ol><li><p>åœ¨å°ˆæ¡ˆçš„æ ¹ <code>build.gradle.kts</code> æª”æ¡ˆä¸­ï¼ˆ<strong>ä¸æ˜¯</strong> <code>shared/build.gradle.kts</code> æª”æ¡ˆï¼‰ï¼Œå°‡ KSPï¼ˆKotlin Symbol Processorï¼‰å’Œ KMP-NativeCoroutines å¤–æ›ç¨‹å¼æ–°å¢åˆ° <code>plugins {}</code> å€å¡Šä¸­ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plugins</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;com.google.devtools.ksp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2.2.0-2.0.2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;com.rickclephas.kmp.nativecoroutines&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.0.0-ALPHA-45&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p>åœ¨ <code>shared/build.gradle.kts</code> æª”æ¡ˆä¸­ï¼Œæ–°å¢ KMP-NativeCoroutines å¤–æ›ç¨‹å¼ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plugins</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;com.google.devtools.ksp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;com.rickclephas.kmp.nativecoroutines&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p>åŒæ¨£åœ¨ <code>shared/build.gradle.kts</code> æª”æ¡ˆä¸­ï¼Œé¸æ“‡åŠ å…¥å¯¦é©—æ€§çš„ <code>@ObjCName</code> è¨»è§£ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kotlin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sourceSets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        all</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            languageSettings</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                optIn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;kotlin.experimental.ExperimentalObjCName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                optIn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;kotlin.time.ExperimentalTime&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p>é»æ“Š<strong>åŒæ­¥ Gradle è®Šæ›´</strong>æŒ‰éˆ•ä»¥åŒæ­¥ Gradle æª”æ¡ˆã€‚</p></li></ol><h4 id="ä½¿ç”¨-kmp-nativecoroutines-æ¨™è¨˜-flow" tabindex="-1">ä½¿ç”¨ KMP-NativeCoroutines æ¨™è¨˜ Flow <a class="header-anchor" href="#ä½¿ç”¨-kmp-nativecoroutines-æ¨™è¨˜-flow" aria-label="Permalink to &quot;ä½¿ç”¨ KMP-NativeCoroutines æ¨™è¨˜ Flow&quot;">â€‹</a></h4><ol><li><p>åœ¨ <code>shared/src/commonMain/kotlin</code> ç›®éŒ„ä¸­é–‹å•Ÿ <code>Greeting.kt</code> æª”æ¡ˆã€‚</p></li><li><p>å°‡ <code>@NativeCoroutines</code> è¨»è§£æ·»åŠ åˆ° <code>greet()</code> å‡½å¼ã€‚é€™å°‡ç¢ºä¿å¤–æ›ç¨‹å¼ç”Ÿæˆæ­£ç¢ºçš„ç¨‹å¼ç¢¼ä»¥æ”¯æ´ iOS ä¸Šçš„æ­£ç¢º Flow è™•ç†ï¼š</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> com.rickclephas.kmp.nativecoroutines.NativeCoroutines</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Greeting</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     @NativeCoroutines</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> greet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Flow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> flow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span></code></pre></div></li></ol><h4 id="åœ¨-xcode-ä¸­ä½¿ç”¨-spm-å°å…¥å‡½å¼åº«" tabindex="-1">åœ¨ Xcode ä¸­ä½¿ç”¨ SPM å°å…¥å‡½å¼åº« <a class="header-anchor" href="#åœ¨-xcode-ä¸­ä½¿ç”¨-spm-å°å…¥å‡½å¼åº«" aria-label="Permalink to &quot;åœ¨ Xcode ä¸­ä½¿ç”¨ SPM å°å…¥å‡½å¼åº«&quot;">â€‹</a></h4><ol><li><p>å‰å¾€ <strong>File</strong> | <strong>Open Project in Xcode</strong>ã€‚</p></li><li><p>åœ¨ Xcode ä¸­ï¼Œå³éµå–®æ“Šå·¦å´é¸å–®ä¸­çš„ <code>iosApp</code> å°ˆæ¡ˆï¼Œç„¶å¾Œé¸æ“‡ <strong>Add Package Dependencies</strong>ã€‚</p></li><li><p>åœ¨æœå°‹æ¬„ä¸­ï¼Œè¼¸å…¥å¥—ä»¶åç¨±ï¼š</p><div class="language-none vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">none</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://github.com/rickclephas/KMP-NativeCoroutines.git</span></span></code></pre></div><p><img src="`+F+'" alt="Importing KMP-NativeCoroutines" width="700"></p></li><li><p>åœ¨<strong>Dependency Rule</strong> ä¸‹æ‹‰é¸å–®ä¸­ï¼Œé¸æ“‡ <strong>Exact Version</strong> é …ç›®ï¼Œä¸¦åœ¨ç›¸é„°æ¬„ä½ä¸­è¼¸å…¥ <code>1.0.0-ALPHA-45</code> ç‰ˆæœ¬ã€‚</p></li><li><p>é»æ“Š<strong>Add Package</strong> æŒ‰éˆ•ï¼šXcode å°‡å¾ GitHub ç²å–å¥—ä»¶ä¸¦é–‹å•Ÿå¦ä¸€å€‹è¦–çª—ä»¥é¸æ“‡å¥—ä»¶ç”¢å“ã€‚</p></li><li><p>å¦‚åœ–æ‰€ç¤ºï¼Œå°‡ã€ŒKMPNativeCoroutinesAsyncã€å’Œã€ŒKMPNativeCoroutinesCoreã€æ–°å¢åˆ°æ‚¨çš„æ‡‰ç”¨ç¨‹å¼ï¼Œç„¶å¾Œé»æ“Š<strong>Add Package</strong>ï¼š</p><p><img src="'+u+`" alt="Add KMP-NativeCoroutines packages" width="500"></p></li></ol><p>é€™æ‡‰è©²æœƒå®‰è£ KMP-NativeCoroutines å¥—ä»¶ä¸­èˆ‡ <code>async/await</code> æ©Ÿåˆ¶å”åŒå·¥ä½œæ‰€éœ€çš„çµ„ä»¶ã€‚</p><h4 id="ä½¿ç”¨-kmp-nativecoroutines-å‡½å¼åº«æ¶ˆè²»-flow" tabindex="-1">ä½¿ç”¨ KMP-NativeCoroutines å‡½å¼åº«æ¶ˆè²» Flow <a class="header-anchor" href="#ä½¿ç”¨-kmp-nativecoroutines-å‡½å¼åº«æ¶ˆè²»-flow" aria-label="Permalink to &quot;ä½¿ç”¨ KMP-NativeCoroutines å‡½å¼åº«æ¶ˆè²» Flow&quot;">â€‹</a></h4><ol><li><p>åœ¨ <code>iosApp/ContentView.swift</code> ä¸­ï¼Œæ›´æ–° <code>startObserving()</code> å‡½å¼ä»¥ä½¿ç”¨ KMP-NativeCoroutines çš„ <code>asyncSequence()</code> å‡½å¼ä¾†æ¶ˆè²» <code>Greeting().greet()</code> å‡½å¼çš„ Flowï¼š</p><div class="language-Swift vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> startObserving</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sequence </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> asyncSequence</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Greeting</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">greet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> try</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> phrase </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sequence {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.greetings.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(phrase)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Failed with error: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\\(error)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>é€™è£¡ä½¿ç”¨è¿´åœˆå’Œ <code>await</code> æ©Ÿåˆ¶ä¾†è¿­ä»£ Flowï¼Œä¸¦åœ¨ Flow æ¯æ¬¡ç™¼å‡ºå€¼æ™‚æ›´æ–° <code>greetings</code> å±¬æ€§ã€‚</p></li><li><p>ç¢ºä¿ <code>ViewModel</code> æ¨™è¨˜äº† <code>@MainActor</code> è¨»è§£ã€‚è©²è¨»è§£ç¢ºä¿ <code>ViewModel</code> ä¸­çš„æ‰€æœ‰ç•°æ­¥æ“ä½œéƒ½åœ¨ä¸»åŸ·è¡Œç·’ä¸Šé‹è¡Œï¼Œä»¥ç¬¦åˆ Kotlin/Native çš„è¦æ±‚ï¼š</p><div class="language-Swift vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> KMPNativeCoroutinesAsync</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> KMPNativeCoroutinesCore</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">extension</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ContentView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    @MainActor</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ObservableObject </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        @Published</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> greetings: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> startObserving</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sequence </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> asyncSequence</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Greeting</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">greet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                for</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> try</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> phrase </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sequence {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                    self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.greetings.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(phrase)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Failed with error: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\\(error)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ol>`,9)),s[26]||(s[26]=i("h3",{"initial-collapse-state":"collapsed",collapsible:"true",id:"é¸é …-2-é…ç½®-skie",tabindex:"-1"},[a("é¸é … 2. é…ç½® SKIE "),i("a",{class:"header-anchor",href:"#é¸é …-2-é…ç½®-skie","aria-label":'Permalink to "é¸é … 2. é…ç½® SKIE {initial-collapse-state="collapsed" collapsible="true"}"'},"â€‹")],-1)),s[27]||(s[27]=p(`<p>è‹¥è¦è¨­å®šå‡½å¼åº«ï¼Œè«‹åœ¨ <code>shared/build.gradle.kts</code> ä¸­æŒ‡å®š SKIE å¤–æ›ç¨‹å¼ï¼Œç„¶å¾Œé»æ“Š<strong>åŒæ­¥ Gradle è®Šæ›´</strong>æŒ‰éˆ•ã€‚</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plugins</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;co.touchlab.skie&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) version </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0.10.4&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="ä½¿ç”¨-skie-æ¶ˆè²»-flow" tabindex="-1">ä½¿ç”¨ SKIE æ¶ˆè²» Flow <a class="header-anchor" href="#ä½¿ç”¨-skie-æ¶ˆè²»-flow" aria-label="Permalink to &quot;ä½¿ç”¨ SKIE æ¶ˆè²» Flow&quot;">â€‹</a></h4><p>æ‚¨å°‡ä½¿ç”¨è¿´åœˆå’Œ <code>await</code> æ©Ÿåˆ¶ä¾†è¿­ä»£ <code>Greeting().greet()</code> Flowï¼Œä¸¦åœ¨ Flow æ¯æ¬¡ç™¼å‡ºå€¼æ™‚æ›´æ–° <code>greetings</code> å±¬æ€§ã€‚</p><p>ç¢ºä¿ <code>ViewModel</code> æ¨™è¨˜äº† <code>@MainActor</code> è¨»è§£ã€‚ è©²è¨»è§£ç¢ºä¿ <code>ViewModel</code> ä¸­çš„æ‰€æœ‰ç•°æ­¥æ“ä½œéƒ½åœ¨ä¸»åŸ·è¡Œç·’ä¸Šé‹è¡Œï¼Œä»¥ç¬¦åˆ Kotlin/Native çš„è¦æ±‚ï¼š</p><div class="language-Swift vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">extension</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ContentView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    @MainActor</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ObservableObject </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        @Published</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> greetings: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> startObserving</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            for</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> phrase </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Greeting</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">greet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.greetings.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(phrase)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="æ¶ˆè²»-viewmodel-ä¸¦é‹è¡Œ-ios-æ‡‰ç”¨ç¨‹å¼" tabindex="-1">æ¶ˆè²» ViewModel ä¸¦é‹è¡Œ iOS æ‡‰ç”¨ç¨‹å¼ <a class="header-anchor" href="#æ¶ˆè²»-viewmodel-ä¸¦é‹è¡Œ-ios-æ‡‰ç”¨ç¨‹å¼" aria-label="Permalink to &quot;æ¶ˆè²» ViewModel ä¸¦é‹è¡Œ iOS æ‡‰ç”¨ç¨‹å¼&quot;">â€‹</a></h3><p>åœ¨ <code>iosApp/iOSApp.swift</code> ä¸­ï¼Œæ›´æ–°æ‡‰ç”¨ç¨‹å¼çš„é€²å…¥é»ï¼š</p><div class="language-swift vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@main</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> iOSApp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">App </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> body: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Scene {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       WindowGroup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">           ContentView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">viewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: ContentView.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>å¾ IntelliJ IDEA é‹è¡Œ <strong>iosApp</strong> é…ç½®ï¼Œä»¥ç¢ºä¿æ‚¨çš„æ‡‰ç”¨ç¨‹å¼é‚è¼¯å·²åŒæ­¥ï¼š</p><p><img src="`+y+'" alt="Final results" width="300"></p><div class="note custom-block"><p class="custom-block-title">NOTE</p><p>æ‚¨å¯ä»¥åœ¨æˆ‘å€‘çš„ GitHub å„²å­˜åº«çš„å…©å€‹åˆ†æ”¯ä¸­æ‰¾åˆ°å°ˆæ¡ˆçš„æœ€çµ‚ç‹€æ…‹ï¼Œå®ƒå€‘å…·æœ‰ä¸åŒçš„å”ç¨‹è§£æ±ºæ–¹æ¡ˆï¼š * <a href="https://github.com/kotlin-hands-on/get-started-with-kmp/tree/main" target="_blank" rel="noreferrer"><code>main</code></a> åˆ†æ”¯åŒ…å«ä¸€å€‹ KMP-NativeCoroutines å¯¦ç¾ï¼Œ * <a href="https://github.com/kotlin-hands-on/get-started-with-kmp/tree/main-skie" target="_blank" rel="noreferrer"><code>main-skie</code></a> åˆ†æ”¯åŒ…å«ä¸€å€‹ SKIE å¯¦ç¾ã€‚</p></div><h2 id="ä¸‹ä¸€æ­¥" tabindex="-1">ä¸‹ä¸€æ­¥ <a class="header-anchor" href="#ä¸‹ä¸€æ­¥" aria-label="Permalink to &quot;ä¸‹ä¸€æ­¥&quot;">â€‹</a></h2><p>åœ¨æœ¬æ•™å­¸èª²ç¨‹çš„æœ€å¾Œä¸€éƒ¨åˆ†ï¼Œæ‚¨å°‡ç¸½çµæ‚¨çš„å°ˆæ¡ˆä¸¦äº†è§£æ¥ä¸‹ä¾†çš„æ­¥é©Ÿã€‚</p><p><strong><a href="./multiplatform-wrap-up">ç¹¼çºŒä¸‹ä¸€éƒ¨åˆ†</a></strong></p><h3 id="å¦è«‹åƒé–±" tabindex="-1">å¦è«‹åƒé–± <a class="header-anchor" href="#å¦è«‹åƒé–±" aria-label="Permalink to &quot;å¦è«‹åƒé–±&quot;">â€‹</a></h3><ul><li>æ¢ç´¢<a href="https://kotlinlang.org/docs/composing-suspending-functions.html" target="_blank" rel="noreferrer">æš«åœå‡½å¼çš„çµ„åˆ</a>çš„å„ç¨®æ–¹æ³•ã€‚</li><li>äº†è§£æ›´å¤šé—œæ–¼<a href="https://kotlinlang.org/docs/native-objc-interop.html" target="_blank" rel="noreferrer">èˆ‡ Objective-C æ¡†æ¶å’Œå‡½å¼åº«çš„äº’æ“ä½œæ€§</a>ã€‚</li><li>å®Œæˆé—œæ–¼<a href="./multiplatform-ktor-sqldelight">ç¶²è·¯å’Œè³‡æ–™å„²å­˜</a>çš„æœ¬æ•™å­¸èª²ç¨‹ã€‚</li></ul><h2 id="å–å¾—å”åŠ©" tabindex="-1">å–å¾—å”åŠ© <a class="header-anchor" href="#å–å¾—å”åŠ©" aria-label="Permalink to &quot;å–å¾—å”åŠ©&quot;">â€‹</a></h2><ul><li><strong>Kotlin Slack</strong>ã€‚å–å¾—<a href="https://surveys.jetbrains.com/s3/kotlin-slack-sign-up" target="_blank" rel="noreferrer">é‚€è«‹</a>ä¸¦åŠ å…¥ <a href="https://kotlinlang.slack.com/archives/C3PQML5NU" target="_blank" rel="noreferrer">#multiplatform</a> é »é“ã€‚</li><li><strong>Kotlin å•é¡Œè¿½è¹¤å™¨</strong>ã€‚<a href="https://youtrack.jetbrains.com/newIssue?project=KT" target="_blank" rel="noreferrer">å›å ±æ–°å•é¡Œ</a>ã€‚</li></ul>',19))])}const L=C(b,[["render",A]]);export{I as __pageData,L as default};
