import{_ as p,C as r,c as E,o as g,j as i,G as e,ag as h,a as s,w as a}from"./chunks/framework.Bksy39di.js";const x=JSON.parse('{"title":"从 1.6.x 迁移到 2.0.x","description":"","frontmatter":{},"headers":[],"relativePath":"ktor/migration-to-20x.md","filePath":"ktor/migration-to-20x.md","lastUpdated":1755457140000}'),c={name:"ktor/migration-to-20x.md"};function y(u,t,F,C,m,f){const d=r("show-structure"),l=r("TabItem"),n=r("Tabs"),k=r("Links"),o=r("list");return g(),E("div",null,[t[65]||(t[65]=i("h1",{id:"从-1-6-x-迁移到-2-0-x",tabindex:"-1"},[s("从 1.6.x 迁移到 2.0.x "),i("a",{class:"header-anchor",href:"#从-1-6-x-迁移到-2-0-x","aria-label":'Permalink to "从 1.6.x 迁移到 2.0.x"'},"​")],-1)),e(d,{for:"chapter",depth:"2"}),t[66]||(t[66]=h('<p>本指南提供了关于如何将你的 Ktor 应用程序从 1.6.x 版本迁移到 2.0.x 版本的说明。</p><h2 id="server" tabindex="-1">Ktor 服务器 <a class="header-anchor" href="#server" aria-label="Permalink to &quot;Ktor 服务器 {id=&quot;server&quot;}&quot;">​</a></h2><h3 id="server-package" tabindex="-1">服务器代码已移动到 &#39;io.ktor.server.*&#39; 包 <a class="header-anchor" href="#server-package" aria-label="Permalink to &quot;服务器代码已移动到 &#39;io.ktor.server.*&#39; 包 {id=&quot;server-package&quot;}&quot;">​</a></h3><p>为了统一并更好地区分服务器和客户端 API，服务器代码已移动到 <code>io.ktor.server.*</code> 包 (<a href="https://youtrack.jetbrains.com/issue/KTOR-2865" target="_blank" rel="noreferrer">KTOR-2865</a>)。 这意味着你需要更新应用程序中的<a href="#server-package-dependencies">依赖项</a>和<a href="#server-package-imports">导入</a>，如下所示。</p><h4 id="server-package-dependencies" tabindex="-1">依赖项 <a class="header-anchor" href="#server-package-dependencies" aria-label="Permalink to &quot;依赖项 {id=&quot;server-package-dependencies&quot;}&quot;">​</a></h4><table tabindex="0"><thead><tr><th style="text-align:left;">子系统</th><th style="text-align:center;">1.6.x</th><th style="text-align:right;">2.0.0</th></tr></thead><tbody><tr><td style="text-align:left;"><a href="https://ktor.io/docs/server-locations.html" target="_blank" rel="noreferrer">Locations</a></td><td style="text-align:center;"><code>io.ktor:ktor-locations</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-locations</code></td></tr><tr><td style="text-align:left;"><a href="./server-webjars">Webjars</a></td><td style="text-align:center;"><code>io.ktor:ktor-webjars</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-webjars</code></td></tr><tr><td style="text-align:left;"><a href="./server-autoheadresponse">AutoHeadResponse</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-auto-head-response</code></td></tr><tr><td style="text-align:left;"><a href="./server-status-pages">StatusPages</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-status-pages</code></td></tr><tr><td style="text-align:left;"><a href="./server-call-id">CallId</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-call-id</code></td></tr><tr><td style="text-align:left;"><a href="./server-double-receive">DoubleReceive</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-double-receive</code></td></tr><tr><td style="text-align:left;"><a href="./server-html-dsl">HTML DSL</a></td><td style="text-align:center;"><code>io.ktor:ktor-html-builder</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-html-builder</code></td></tr><tr><td style="text-align:left;"><a href="./server-freemarker">FreeMarker</a></td><td style="text-align:center;"><code>io.ktor:ktor-freemarker</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-freemarker</code></td></tr><tr><td style="text-align:left;"><a href="./server-velocity">Velocity</a></td><td style="text-align:center;"><code>io.ktor:ktor-velocity</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-velocity</code></td></tr><tr><td style="text-align:left;"><a href="./server-mustache">Mustache</a></td><td style="text-align:center;"><code>io.ktor:ktor-mustache</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-mustache</code></td></tr><tr><td style="text-align:left;"><a href="./server-thymeleaf">Thymeleaf</a></td><td style="text-align:center;"><code>io.ktor:ktor-thymeleaf</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-thymeleaf</code></td></tr><tr><td style="text-align:left;"><a href="./server-pebble">Pebble</a></td><td style="text-align:center;"><code>io.ktor:ktor-pebble</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-pebble</code></td></tr><tr><td style="text-align:left;"><a href="./server-serialization">kotlinx.serialization</a></td><td style="text-align:center;"><code>io.ktor:ktor-serialization</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-content-negotiation</code>, <code>io.ktor:ktor-serialization-kotlinx-json</code></td></tr><tr><td style="text-align:left;"><a href="./server-serialization">Gson</a></td><td style="text-align:center;"><code>io.ktor:ktor-gson</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-content-negotiation</code>, <code>io.ktor:ktor-serialization-gson</code></td></tr><tr><td style="text-align:left;"><a href="./server-serialization">Jackson</a></td><td style="text-align:center;"><code>io.ktor:ktor-jackson</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-content-negotiation</code>, <code>io.ktor:ktor-serialization-jackson</code></td></tr><tr><td style="text-align:left;"><a href="./server-auth">Authentication</a></td><td style="text-align:center;"><code>io.ktor:ktor-auth</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-auth</code></td></tr><tr><td style="text-align:left;"><a href="./server-jwt">JWT authentication</a></td><td style="text-align:center;"><code>io.ktor:ktor-auth-jwt</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-auth-jwt</code></td></tr><tr><td style="text-align:left;"><a href="./server-ldap">LDAP authentication</a></td><td style="text-align:center;"><code>io.ktor:ktor-auth-ldap</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-auth-ldap</code></td></tr><tr><td style="text-align:left;"><a href="./server-data-conversion">DataConversion</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-data-conversion</code></td></tr><tr><td style="text-align:left;"><a href="./server-default-headers">DefaultHeaders</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-default-headers</code></td></tr><tr><td style="text-align:left;"><a href="./server-compression">Compression</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-compression</code></td></tr><tr><td style="text-align:left;"><a href="./server-caching-headers">CachingHeaders</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-caching-headers</code></td></tr><tr><td style="text-align:left;"><a href="./server-conditional-headers">ConditionalHeaders</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-conditional-headers</code></td></tr><tr><td style="text-align:left;"><a href="./server-cors">CORS</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-cors</code></td></tr><tr><td style="text-align:left;"><a href="./server-forward-headers">Forwarded headers</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-forwarded-header</code></td></tr><tr><td style="text-align:left;"><a href="./server-hsts">HSTS</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-hsts</code></td></tr><tr><td style="text-align:left;"><a href="./server-https-redirect">HttpsRedirect</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-http-redirect</code></td></tr><tr><td style="text-align:left;"><a href="./server-partial-content">PartialContent</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-partial-content</code></td></tr><tr><td style="text-align:left;"><a href="./server-websockets">WebSockets</a></td><td style="text-align:center;"><code>io.ktor:ktor-websockets</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-websockets</code></td></tr><tr><td style="text-align:left;"><a href="./server-call-logging">CallLogging</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-call-logging</code></td></tr><tr><td style="text-align:left;"><a href="./server-metrics-micrometer">Micrometer metric</a></td><td style="text-align:center;"><code>io.ktor:ktor-metrics-micrometer</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-metrics-micrometer</code></td></tr><tr><td style="text-align:left;"><a href="./server-metrics-dropwizard">Dropwizard metrics</a></td><td style="text-align:center;"><code>io.ktor:ktor-metrics</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-metrics</code></td></tr><tr><td style="text-align:left;"><a href="./server-sessions">Sessions</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-sessions</code></td></tr></tbody></table><blockquote><p>要一次性添加所有插件，你可以使用 <code>io.ktor:ktor-server</code> 构件。</p></blockquote><h4 id="server-package-imports" tabindex="-1">导入 <a class="header-anchor" href="#server-package-imports" aria-label="Permalink to &quot;导入 {id=&quot;server-package-imports&quot;}&quot;">​</a></h4><table tabindex="0"><thead><tr><th style="text-align:left;">子系统</th><th style="text-align:center;">1.6.x</th><th style="text-align:right;">2.0.0</th></tr></thead><tbody><tr><td style="text-align:left;"><a href="./server-create-and-configure">Application</a></td><td style="text-align:center;"><code>import io.ktor.application.*</code></td><td style="text-align:right;"><code>import io.ktor.server.application.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-configuration-file">Configuration</a></td><td style="text-align:center;"><code>import io.ktor.config.*</code></td><td style="text-align:right;"><code>import io.ktor.server.config.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-routing">Routing</a></td><td style="text-align:center;"><code>import io.ktor.routing.*</code></td><td style="text-align:right;"><code>import io.ktor.server.routing.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-autoheadresponse">AutoHeadResponse</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.autohead.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-status-pages">StatusPages</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.statuspages.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-call-id">CallId</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.callid.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-double-receive">DoubleReceive</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.doublereceive.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-requests">Requests</a></td><td style="text-align:center;"><code>import io.ktor.request.*</code></td><td style="text-align:right;"><code>import io.ktor.server.request.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-responses">Responses</a></td><td style="text-align:center;"><code>import io.ktor.response.*</code></td><td style="text-align:right;"><code>import io.ktor.server.response.*</code></td></tr><tr><td style="text-align:left;"><a href="#feature-plugin">插件</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.*</code></td></tr><tr><td style="text-align:left;"><a href="https://ktor.io/docs/server-locations.html" target="_blank" rel="noreferrer">Locations</a></td><td style="text-align:center;"><code>import io.ktor.locations.*</code></td><td style="text-align:right;"><code>import io.ktor.server.locations.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-static-content">Static content</a></td><td style="text-align:center;"><code>import io.ktor.http.content.*</code></td><td style="text-align:right;"><code>import io.ktor.server.http.content.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-html-dsl">HTML DSL</a></td><td style="text-align:center;"><code>import io.ktor.html.*</code></td><td style="text-align:right;"><code>import io.ktor.server.html.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-freemarker">FreeMarker</a></td><td style="text-align:center;"><code>import io.ktor.freemarker.*</code></td><td style="text-align:right;"><code>import io.ktor.server.freemarker.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-velocity">Velocity</a></td><td style="text-align:center;"><code>import io.ktor.velocity.*</code></td><td style="text-align:right;"><code>import io.ktor.server.velocity.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-mustache">Mustache</a></td><td style="text-align:center;"><code>import io.ktor.mustache.*</code></td><td style="text-align:right;"><code>import io.ktor.server.mustache.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-thymeleaf">Thymeleaf</a></td><td style="text-align:center;"><code>import io.ktor.thymeleaf.*</code></td><td style="text-align:right;"><code>import io.ktor.server.thymeleaf.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-pebble">Pebble</a></td><td style="text-align:center;"><code>import io.ktor.pebble.*</code></td><td style="text-align:right;"><code>import io.ktor.server.pebble.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-serialization">ContentNegotiation</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.contentnegotiation.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-serialization">kotlinx.serialization</a></td><td style="text-align:center;"><code>import io.ktor.serialization.*</code></td><td style="text-align:right;"><code>import io.ktor.serialization.kotlinx.json.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-serialization">Gson</a></td><td style="text-align:center;"><code>import io.ktor.gson.*</code></td><td style="text-align:right;"><code>import io.ktor.serialization.gson.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-serialization">Jackson</a></td><td style="text-align:center;"><code>import io.ktor.jackson.*</code></td><td style="text-align:right;"><code>import io.ktor.serialization.jackson.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-auth">Authentication</a></td><td style="text-align:center;"><code>import io.ktor.auth.*</code></td><td style="text-align:right;"><code>import io.ktor.server.auth.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-jwt">JWT authentication</a></td><td style="text-align:center;"><code>import io.ktor.auth.jwt.*</code></td><td style="text-align:right;"><code>import io.ktor.server.auth.jwt.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-ldap">LDAP authentication</a></td><td style="text-align:center;"><code>import io.ktor.auth.ldap.*</code></td><td style="text-align:right;"><code>import io.ktor.server.auth.ldap.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-sessions">Sessions</a></td><td style="text-align:center;"><code>import io.ktor.sessions.*</code></td><td style="text-align:right;"><code>import io.ktor.server.sessions.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-default-headers">DefaultHeaders</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.defaultheaders.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-compression">Compression</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.compression.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-caching-headers">CachingHeaders</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.cachingheaders.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-conditional-headers">ConditionalHeaders</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.conditionalheaders.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-cors">CORS</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.cors.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-forward-headers">Forwarded headers</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.forwardedheaders.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-hsts">HSTS</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.hsts.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-https-redirect">HttpsRedirect</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.httpsredirect.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-partial-content">PartialContent</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.partialcontent.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-websockets">WebSockets</a></td><td style="text-align:center;"><code>import io.ktor.websocket.*</code></td><td style="text-align:right;"><code>import io.ktor.server.websocket.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-call-logging">CallLogging</a></td><td style="text-align:center;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.callloging.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-metrics-micrometer">Micrometer metric</a></td><td style="text-align:center;"><code>import io.ktor.metrics.micrometer.*</code></td><td style="text-align:right;"><code>import io.ktor.server.metrics.micrometer.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-metrics-dropwizard">Dropwizard metrics</a></td><td style="text-align:center;"><code>import io.ktor.metrics.dropwizard.*</code></td><td style="text-align:right;"><code>import io.ktor.server.metrics.dropwizard.*</code></td></tr></tbody></table><h3 id="server-ws-package" tabindex="-1">WebSockets 代码已移动到 &#39;websockets&#39; 包 <a class="header-anchor" href="#server-ws-package" aria-label="Permalink to &quot;WebSockets 代码已移动到 &#39;websockets&#39; 包 {id=&quot;server-ws-package&quot;}&quot;">​</a></h3><p>WebSockets 代码已从 <code>http-cio</code> 移动到 <code>websockets</code> 包。这需要如下更新导入：</p><table tabindex="0"><thead><tr><th style="text-align:left;">1.6.x</th><th style="text-align:right;">2.0.0</th></tr></thead><tbody><tr><td style="text-align:left;"><code>import io.ktor.http.cio.websocket.*</code></td><td style="text-align:right;"><code>import io.ktor.websocket.*</code></td></tr></tbody></table><p>请注意，此更改也影响<a href="#client-ws-package">客户端</a>。</p><h3 id="feature-plugin" tabindex="-1">Feature 已重命名为 Plugin <a class="header-anchor" href="#feature-plugin" aria-label="Permalink to &quot;Feature 已重命名为 Plugin {id=&quot;feature-plugin&quot;}&quot;">​</a></h3><p>在 Ktor 2.0.0 中，<code>Feature</code> 已重命名为<a href="./server-plugins">Plugin</a>，以更好地描述拦截请求/响应流水线的功能性 (<a href="https://youtrack.jetbrains.com/issue/KTOR-2326" target="_blank" rel="noreferrer">KTOR-2326</a>)。 这影响了整个 Ktor API，需要你如下所述更新应用程序。</p><h4 id="feature-plugin-imports" tabindex="-1">导入 <a class="header-anchor" href="#feature-plugin-imports" aria-label="Permalink to &quot;导入 {id=&quot;feature-plugin-imports&quot;}&quot;">​</a></h4><p><a href="./server-plugins#install">安装任何插件</a>都需要更新导入，并且还取决于<a href="#server-package-imports">服务器代码</a>已移动到 <code>io.ktor.server.*</code> 包。</p><table tabindex="0"><thead><tr><th style="text-align:left;">1.6.x</th><th style="text-align:right;">2.0.0</th></tr></thead><tbody><tr><td style="text-align:left;"><code>import io.ktor.features.*</code></td><td style="text-align:right;"><code>import io.ktor.server.plugins.*</code></td></tr></tbody></table><h4 id="feature-plugin-custom" tabindex="-1">自定义插件 <a class="header-anchor" href="#feature-plugin-custom" aria-label="Permalink to &quot;自定义插件 {id=&quot;feature-plugin-custom&quot;}&quot;">​</a></h4><p>将 Feature 重命名为 Plugin 为<a href="./server-custom-plugins-base-api">自定义插件</a>相关的 API 引入了以下更改：</p><ul><li><code>ApplicationFeature</code> 接口已重命名为 <code>BaseApplicationPlugin</code>。</li><li><code>Features</code> <a href="./server-custom-plugins-base-api#pipelines">流水线阶段</a>已重命名为 <code>Plugins</code>。</li></ul><blockquote><p>请注意，从 v2.0.0 开始，Ktor 提供了<a href="./server-custom-plugins">创建自定义插件</a>的新 API。通常，此 API 不需要理解 Ktor 内部概念，例如流水线、阶段等等。取而代之的是，你可以使用各种处理程序（例如 <code>onCall</code>、<code>onCallReceive</code>、<code>onCallRespond</code> 等等）访问处理请求和响应的不同阶段。你可以从本节了解流水线阶段如何映射到新 API 处理程序：<a href="./server-custom-plugins-base-api#mapping">流水线阶段到新 API 处理程序的映射</a>。</p></blockquote><h3 id="serialization" tabindex="-1">内容协商和序列化 <a class="header-anchor" href="#serialization" aria-label="Permalink to &quot;内容协商和序列化 {id=&quot;serialization&quot;}&quot;">​</a></h3><p><a href="./server-serialization">内容协商和序列化</a>服务器 API 已重构，以便在服务器和客户端之间重用序列化库。 主要更改是：</p><ul><li><code>ContentNegotiation</code> 已从 <code>ktor-server-core</code> 移动到一个单独的 <code>ktor-server-content-negotiation</code> 构件。</li><li>序列化库已从 <code>ktor-*</code> 移动到客户端也使用的 <code>ktor-serialization-*</code> 构件。</li></ul><p>你需要更新应用程序中的<a href="#dependencies-serialization">依赖项</a>和<a href="#imports-serialization">导入</a>，如下所示。</p><h4 id="dependencies-serialization" tabindex="-1">依赖项 <a class="header-anchor" href="#dependencies-serialization" aria-label="Permalink to &quot;依赖项 {id=&quot;dependencies-serialization&quot;}&quot;">​</a></h4><table tabindex="0"><thead><tr><th style="text-align:left;">子系统</th><th style="text-align:center;">1.6.x</th><th style="text-align:right;">2.0.0</th></tr></thead><tbody><tr><td style="text-align:left;"><a href="./server-serialization">ContentNegotiation</a></td><td style="text-align:center;"><code>io.ktor:ktor-server-core</code></td><td style="text-align:right;"><code>io.ktor:ktor-server-content-negotiation</code></td></tr><tr><td style="text-align:left;"><a href="./server-serialization">kotlinx.serialization</a></td><td style="text-align:center;"><code>io.ktor:ktor-serialization</code></td><td style="text-align:right;"><code>io.ktor:ktor-serialization-kotlinx-json</code></td></tr><tr><td style="text-align:left;"><a href="./server-serialization">Gson</a></td><td style="text-align:center;"><code>io.ktor:ktor-gson</code></td><td style="text-align:right;"><code>io.ktor:ktor-serialization-gson</code></td></tr><tr><td style="text-align:left;"><a href="./server-serialization">Jackson</a></td><td style="text-align:center;"><code>io.ktor:ktor-jackson</code></td><td style="text-align:right;"><code>io.ktor:ktor-serialization-jackson</code></td></tr></tbody></table><h4 id="imports-serialization" tabindex="-1">导入 <a class="header-anchor" href="#imports-serialization" aria-label="Permalink to &quot;导入 {id=&quot;imports-serialization&quot;}&quot;">​</a></h4><table tabindex="0"><thead><tr><th style="text-align:left;">子系统</th><th style="text-align:center;">1.6.x</th><th style="text-align:right;">2.0.0</th></tr></thead><tbody><tr><td style="text-align:left;"><a href="./server-serialization">kotlinx.serialization</a></td><td style="text-align:center;"><code>import io.ktor.serialization.*</code></td><td style="text-align:right;"><code>import io.ktor.serialization.kotlinx.json.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-serialization">Gson</a></td><td style="text-align:center;"><code>import io.ktor.gson.*</code></td><td style="text-align:right;"><code>import io.ktor.serialization.gson.*</code></td></tr><tr><td style="text-align:left;"><a href="./server-serialization">Jackson</a></td><td style="text-align:center;"><code>import io.ktor.jackson.*</code></td><td style="text-align:right;"><code>import io.ktor.serialization.jackson.*</code></td></tr></tbody></table><h4 id="serialization-custom-converter" tabindex="-1">自定义转换器 <a class="header-anchor" href="#serialization-custom-converter" aria-label="Permalink to &quot;自定义转换器 {id=&quot;serialization-custom-converter&quot;}&quot;">​</a></h4><p><a href="./server-serialization#implement_custom_serializer">ContentConverter</a> 接口暴露的函数签名已按以下方式更改：</p>',32)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[0]||(t[0]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"interface"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," ContentConverter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    suspend"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," convertForSend"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(context: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"PipelineContext"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Any"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ApplicationCall"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">, contentType: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ContentType"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"value"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Any"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"): "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Any"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"?")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    suspend"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," convertForReceive"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(context: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"PipelineContext"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ApplicationReceiveRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ApplicationCall"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">): "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Any"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"?")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[1]||(t[1]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"interface"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," ContentConverter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    suspend"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," serialize"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(contentType: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ContentType"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", charset: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Charset"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", typeInfo: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"TypeInfo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"value"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Any"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"): "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"OutgoingContent"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"?")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    suspend"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," deserialize"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(charset: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Charset"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", typeInfo: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"TypeInfo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", content: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ByteReadChannel"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"): "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Any"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"?")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1}),t[67]||(t[67]=h('<h3 id="testing-api" tabindex="-1">测试 API <a class="header-anchor" href="#testing-api" aria-label="Permalink to &quot;测试 API {id=&quot;testing-api&quot;}&quot;">​</a></h3><p>从 v2.0.0 开始，Ktor 服务器使用新的<a href="./server-testing">测试</a> API，解决了 <a href="https://youtrack.jetbrains.com/issue/KTOR-971" target="_blank" rel="noreferrer">KTOR-971</a> 中描述的各种问题。主要更改是：</p><ul><li><code>withTestApplication</code>/<code>withApplication</code> 函数已替换为新的 <code>testApplication</code> 函数。</li><li>在 <code>testApplication</code> 函数内部，你需要使用现有的 <a href="./client-create-and-configure">Ktor 客户端</a>实例向服务器发出请求并验证结果。</li><li>要测试特定功能（例如，cookies 或 WebSockets），你需要创建一个新的客户端实例并安装相应的<a href="./client-plugins">插件</a>。</li></ul><p>让我们来看几个将 1.6.x 测试迁移到 2.0.0 的示例：</p><h4 id="basic-test" tabindex="-1">基本服务器测试 <a class="header-anchor" href="#basic-test" aria-label="Permalink to &quot;基本服务器测试 {id=&quot;basic-test&quot;}&quot;">​</a></h4><p>在下面的测试中，<code>handleRequest</code> 函数已替换为 <code>client.get</code> 请求：</p>',6)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[2]||(t[2]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"@Test")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testRootLegacyApi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    withTestApplication"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Application::"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"module"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        handleRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpMethod.Get, "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"apply"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpStatusCode.OK, response."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"status"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Hello, world!"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", response.content)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[3]||(t[3]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"@Test")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testRoot"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testApplication"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpStatusCode.OK, response.status)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Hello, world!"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", response."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bodyAsText"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1}),t[68]||(t[68]=i("h4",{id:"x-www-form-urlencoded",tabindex:"-1"},[s("x-www-form-urlencoded "),i("a",{class:"header-anchor",href:"#x-www-form-urlencoded","aria-label":'Permalink to "x-www-form-urlencoded {id="x-www-form-urlencoded"}"'},"​")],-1)),t[69]||(t[69]=i("p",null,[s("在下面的测试中，"),i("code",null,"handleRequest"),s(" 函数已替换为 "),i("code",null,"client.post"),s(" 请求：")],-1)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[4]||(t[4]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"@Test")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testPostLegacyApi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," withTestApplication"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Application::"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"main"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    with"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"handleRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpMethod.Post, "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/signup"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        addHeader"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpHeaders.ContentType, ContentType.Application.FormUrlEncoded."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        setBody"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"listOf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"username"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," to "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"JetBrains"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"email"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," to "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"example@jetbrains.com"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"password"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," to "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"foobar"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"confirmation"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," to "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"foobar"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"formUrlEncode"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},`"The 'JetBrains' account is created"`),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", response.content)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[5]||(t[5]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"@Test")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testPost"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testApplication"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"post"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/signup"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        header"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpHeaders.ContentType, ContentType.Application.FormUrlEncoded."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        setBody"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"listOf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"username"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," to "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"JetBrains"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"email"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," to "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"example@jetbrains.com"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"password"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," to "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"foobar"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"confirmation"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," to "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"foobar"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"formUrlEncode"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},`"The 'JetBrains' account is created"`),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", response."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bodyAsText"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1}),t[70]||(t[70]=i("h4",{id:"multipart-form-data",tabindex:"-1"},[s("multipart/form-data "),i("a",{class:"header-anchor",href:"#multipart-form-data","aria-label":'Permalink to "multipart/form-data {id="multipart-form-data"}"'},"​")],-1)),t[71]||(t[71]=i("p",null,[s("要在 v2.0.0 中构建 "),i("code",null,"multipart/form-data"),s("，你需要将 "),i("code",null,"MultiPartFormDataContent"),s(" 传递给客户端的 "),i("code",null,"setBody"),s(" 函数：")],-1)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[6]||(t[6]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    @Test")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testUploadLegacyApi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," withTestApplication"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Application::"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"main"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        with"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"handleRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpMethod.Post, "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/upload"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," boundary "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "WebAppBoundary"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," fileBytes "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," File"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ktor_logo.png"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"readBytes"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            addHeader"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpHeaders.ContentType, ContentType.MultiPart.FormData."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"withParameter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"boundary"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", boundary)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            setBody"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(boundary, "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"listOf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                PartData."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"FormItem"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Ktor logo"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", { }, "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"headersOf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    HttpHeaders.ContentDisposition,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ContentDisposition.Inline")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"withParameter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(ContentDisposition.Parameters.Name, "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"description"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                )),")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                PartData."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"FileItem"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"({ fileBytes."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"inputStream"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"asInput"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() }, {}, "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"headersOf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    HttpHeaders.ContentDisposition,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ContentDisposition.File")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"withParameter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(ContentDisposition.Parameters.Name, "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"image"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"withParameter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(ContentDisposition.Parameters.FileName, "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ktor_logo.png"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ))")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            ))")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},`"Ktor logo is uploaded to 'uploads/ktor_logo.png'"`),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", response.content)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[7]||(t[7]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"@Test")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testUpload"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testApplication"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," boundary "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "WebAppBoundary"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"post"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/upload"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        setBody"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            MultiPartFormDataContent"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                formData"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                    append"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"description"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Ktor logo"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                    append"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"image"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"File"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ktor_logo.png"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"readBytes"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(), Headers."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                        append"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpHeaders.ContentType, "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"image/png"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                        append"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpHeaders.ContentDisposition, "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"filename='),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ktor_logo.png"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    })")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                },")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                boundary,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ContentType.MultiPart.FormData."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"withParameter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"boundary"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", boundary)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            )")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        )")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},`"Ktor logo is uploaded to 'uploads/ktor_logo.png'"`),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", response."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bodyAsText"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1}),t[72]||(t[72]=i("h4",{id:"json-data",tabindex:"-1"},[s("JSON 数据 "),i("a",{class:"header-anchor",href:"#json-data","aria-label":'Permalink to "JSON 数据 {id="json-data"}"'},"​")],-1)),t[73]||(t[73]=i("p",null,[s("在 v1.6.x 中，你可以使用 "),i("code",null,"kotlinx.serialization"),s(" 库提供的 "),i("code",null,"Json.encodeToString"),s(" 函数序列化 JSON 数据。 从 v2.0.0 开始，你需要创建一个新的客户端实例并安装 "),i("a",{href:"./client-serialization"},"ContentNegotiation"),s(" 插件，该插件允许以特定格式序列化/反序列化内容：")],-1)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[8]||(t[8]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"@Test")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testPostCustomerLegacyApi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," withTestApplication"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Application::"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"main"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    with"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"handleRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpMethod.Post, "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/customer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        addHeader"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpHeaders.ContentType, ContentType.Application.Json."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        setBody"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Json."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"encodeToString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Customer"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Jet"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Brains"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")))")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Customer stored correctly"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", response.content)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpStatusCode.Created, response."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"status"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[9]||(t[9]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"@Test")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testPostCustomer"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testApplication"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," createClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        install"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(ContentNegotiation) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            json"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"post"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/customer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        contentType"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(ContentType.Application.Json)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        setBody"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Customer"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Jet"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Brains"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"))")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Customer stored correctly"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", response."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bodyAsText"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpStatusCode.Created, response.status)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1}),t[74]||(t[74]=i("h4",{id:"preserving-cookies",tabindex:"-1"},[s("测试期间保留 cookie "),i("a",{class:"header-anchor",href:"#preserving-cookies","aria-label":'Permalink to "测试期间保留 cookie {id="preserving-cookies"}"'},"​")],-1)),t[75]||(t[75]=i("p",null,[s("在 v1.6.x 中，"),i("code",null,"cookiesSession"),s(" 用于在测试时保留请求之间的 cookie。从 v2.0.0 开始，你需要创建一个新的客户端实例并安装 "),i("a",{href:"./client-cookies"},"HttpCookies"),s(" 插件：")],-1)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[10]||(t[10]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    @Test")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testRequestsLegacyApi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," withTestApplication"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Application::"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"main"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," doRequestAndCheckResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(path: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"String"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", expected: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"String"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            handleRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpMethod.Get, path)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"apply"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(expected, response.content)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        cookiesSession"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            handleRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpMethod.Get, "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/login"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {}."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"apply"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            doRequestAndCheckResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/user"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Session ID is 123abc. Reload count is 0."'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            doRequestAndCheckResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/user"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Session ID is 123abc. Reload count is 1."'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            doRequestAndCheckResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/user"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Session ID is 123abc. Reload count is 2."'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            handleRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpMethod.Get, "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/logout"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"apply"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            doRequestAndCheckResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/user"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},`"Session doesn't exist or is expired."`),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[11]||(t[11]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    @Test")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testRequests"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testApplication"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," createClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            install"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpCookies)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," loginResponse "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/login"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response1 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/user"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Session ID is 123abc. Reload count is 1."'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", response1."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bodyAsText"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response2 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/user"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Session ID is 123abc. Reload count is 2."'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", response2."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bodyAsText"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response3 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/user"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Session ID is 123abc. Reload count is 3."'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", response3."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bodyAsText"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," logoutResponse "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/logout"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},`"Session doesn't exist or is expired."`),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", logoutResponse."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bodyAsText"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])])],-1)])),_:1})]),_:1}),t[76]||(t[76]=i("h4",{id:"testing-ws",tabindex:"-1"},[s("WebSockets "),i("a",{class:"header-anchor",href:"#testing-ws","aria-label":'Permalink to "WebSockets {id="testing-ws"}"'},"​")],-1)),t[77]||(t[77]=i("p",null,[s("在旧 API 中，"),i("code",null,"handleWebSocketConversation"),s(" 用于测试 "),i("a",{href:"./server-websockets"},"WebSocket 会话"),s("。从 v2.0.0 开始，你可以通过使用客户端提供的 "),i("a",{href:"./client-websockets"},"WebSockets"),s(" 插件来测试 WebSocket 会话：")],-1)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[12]||(t[12]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    @Test")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testConversationLegacyApi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        withTestApplication"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Application::"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"module"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            handleWebSocketConversation"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/echo"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") { incoming, outgoing "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," greetingText "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (incoming."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"receive"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Frame.Text)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"readText"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Please enter your name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", greetingText)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                outgoing."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"send"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Frame."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Text"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"JetBrains"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"))")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," responseText "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (incoming."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"receive"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Frame.Text)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"readText"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Hi, JetBrains!"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", responseText)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[13]||(t[13]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    @Test")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    fun"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testConversation"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        testApplication"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," createClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                install"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(WebSockets)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"webSocket"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/echo"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," greetingText "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (incoming."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"receive"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"? Frame.Text)?."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"readText"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() ?: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Please enter your name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", greetingText)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                send"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Frame."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Text"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"JetBrains"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"))")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," responseText "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (incoming."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"receive"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Frame.Text)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"readText"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                assertEquals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Hi, JetBrains!"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", responseText)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])])],-1)])),_:1})]),_:1}),t[78]||(t[78]=h('<h3 id="double-receive" tabindex="-1">DoubleReceive <a class="header-anchor" href="#double-receive" aria-label="Permalink to &quot;DoubleReceive {id=&quot;double-receive&quot;}&quot;">​</a></h3><p>从 v2.0.0 开始，<a href="./server-double-receive">DoubleReceive</a> 插件配置引入了 <code>cacheRawRequest</code> 属性，它与 <code>receiveEntireContent</code> 相反：</p><ul><li>在 v1.6.x 中，<code>receiveEntireContent</code> 属性默认设置为 <code>false</code>。</li><li>在 v2.0.0 中，<code>cacheRawRequest</code> 默认设置为 <code>true</code>。<code>receiveEntireContent</code> 属性已移除。</li></ul><h3 id="forwarded-headers" tabindex="-1">Forwarded headers <a class="header-anchor" href="#forwarded-headers" aria-label="Permalink to &quot;Forwarded headers {id=&quot;forwarded-headers&quot;}&quot;">​</a></h3><p>在 v2.0.0 中，<code>ForwardedHeaderSupport</code> 和 <code>XForwardedHeaderSupport</code> 插件分别重命名为 <a href="./server-forward-headers">ForwardedHeaders</a> 和 <code>XForwardedHeaders</code>。</p><h3 id="caching-headers" tabindex="-1">缓存头 <a class="header-anchor" href="#caching-headers" aria-label="Permalink to &quot;缓存头 {id=&quot;caching-headers&quot;}&quot;">​</a></h3><p>用于定义缓存选项的 <a href="./server-caching-headers#configure">options</a> 函数现在除了接受 <code>OutgoingContent</code> 之外，还接受 <code>ApplicationCall</code> 作为 lambda 实参：</p>',7)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[14]||(t[14]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"install"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(CachingHeaders) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    options"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { outgoingContent "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // ...")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[15]||(t[15]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"install"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(CachingHeaders) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    options"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { call, outgoingContent "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // ...")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1}),t[79]||(t[79]=i("h3",{id:"conditional-headers",tabindex:"-1"},[s("条件头 "),i("a",{class:"header-anchor",href:"#conditional-headers","aria-label":'Permalink to "条件头 {id="conditional-headers"}"'},"​")],-1)),t[80]||(t[80]=i("p",null,[s("用于定义资源版本列表的 "),i("a",{href:"./server-conditional-headers#configure"},"version"),s(" 函数现在除了接受 "),i("code",null,"OutgoingContent"),s(" 之外，还接受 "),i("code",null,"ApplicationCall"),s(" 作为 lambda 实参：")],-1)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[16]||(t[16]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"install"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(ConditionalHeaders) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    version"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { outgoingContent "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // ... ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[17]||(t[17]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"install"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(ConditionalHeaders) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    version"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { call, outgoingContent "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // ... ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1}),t[81]||(t[81]=h('<h3 id="cors" tabindex="-1">CORS <a class="header-anchor" href="#cors" aria-label="Permalink to &quot;CORS {id=&quot;cors&quot;}&quot;">​</a></h3><p><a href="./server-cors">CORS</a> 配置中使用的几个函数已重命名：</p><ul><li><code>host</code> -&gt; <code>allowHost</code></li><li><code>header</code> -&gt; <code>allowHeader</code></li><li><code>method</code> -&gt; <code>allowMethod</code></li></ul>',3)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[18]||(t[18]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"install"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(CORS) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    host"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"0.0.0.0:5000"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    header"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpHeaders.ContentType)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    method"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpMethod.Options)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[19]||(t[19]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"install"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(CORS) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    allowHost"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"0.0.0.0:5000"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    allowHeader"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpHeaders.ContentType)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    allowMethod"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpMethod.Options)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1}),t[82]||(t[82]=h('<h3 id="micrometer-metrics" tabindex="-1">MicrometerMetrics <a class="header-anchor" href="#micrometer-metrics" aria-label="Permalink to &quot;MicrometerMetrics {id=&quot;micrometer-metrics&quot;}&quot;">​</a></h3><p>在 v1.6.x 中，<code>baseName</code> 属性用于指定用于监控 HTTP 请求的 <a href="./server-metrics-micrometer">Ktor 指标</a>的基本名称（前缀）。 默认情况下，它等于 <code>ktor.http.server</code>。 从 v2.0.0 开始，<code>baseName</code> 已替换为 <code>metricName</code>，其默认值为 <code>ktor.http.server.requests</code>。</p><h2 id="client" tabindex="-1">Ktor 客户端 <a class="header-anchor" href="#client" aria-label="Permalink to &quot;Ktor 客户端 {id=&quot;client&quot;}&quot;">​</a></h2><h3 id="request-response" tabindex="-1">请求和响应 <a class="header-anchor" href="#request-response" aria-label="Permalink to &quot;请求和响应 {id=&quot;request-response&quot;}&quot;">​</a></h3><p>在 v2.0.0 中，用于发出请求和接收响应的 API 已更新，使其更一致、更易发现 (<a href="https://youtrack.jetbrains.com/issue/KTOR-29" target="_blank" rel="noreferrer">KTOR-29</a>)。</p><h4 id="request-overloads" tabindex="-1">请求函数 <a class="header-anchor" href="#request-overloads" aria-label="Permalink to &quot;请求函数 {id=&quot;request-overloads&quot;}&quot;">​</a></h4><p>带有多个形参的<a href="./client-requests">请求函数</a>已弃用。例如，<code>port</code> 和 <code>path</code> 形参需要替换为 <a href="https://api.ktor.io/ktor-client/ktor-client-core/io.ktor.client.request/-http-request-builder/index.html" target="_blank" rel="noreferrer">HttpRequestBuilder</a> 暴露的 <code>url</code> 形参：</p>',7)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[20]||(t[20]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(port "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 8080"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", path "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/customer/3"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[21]||(t[21]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"url"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(port "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 8080"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", path "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/customer/3"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") }")])])])],-1)])),_:1})]),_:1}),t[83]||(t[83]=h('<p><code>HttpRequestBuilder</code> 还允许你在请求函数 lambda 内部指定额外的<a href="./client-requests#parameters">请求形参</a>。</p><h4 id="request-body" tabindex="-1">请求体 <a class="header-anchor" href="#request-body" aria-label="Permalink to &quot;请求体 {id=&quot;request-body&quot;}&quot;">​</a></h4><p>用于设置<a href="./client-requests#body">请求体</a>的 <code>HttpRequestBuilder.body</code> 属性已替换为 <code>HttpRequestBuilder.setBody</code> 函数：</p>',3)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[22]||(t[22]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"post"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"http://localhost:8080/post"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    body "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "Body content"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[23]||(t[23]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"post"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"http://localhost:8080/post"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    setBody"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Body content"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1}),t[84]||(t[84]=h('<h4 id="responses" tabindex="-1">响应 <a class="header-anchor" href="#responses" aria-label="Permalink to &quot;响应 {id=&quot;responses&quot;}&quot;">​</a></h4><p>从 v2.0.0 开始，请求函数（例如 <code>get</code>、<code>post</code>、<code>put</code>、<a href="./client-requests#form_parameters">submitForm</a> 等等）不接受用于接收特定类型对象的泛型实参。 现在所有请求函数都返回一个 <code>HttpResponse</code> 对象，该对象暴露了带有泛型实参的 <code>body</code> 函数，用于接收特定类型实例。 你也可以使用 <code>bodyAsText</code> 或 <code>bodyAsChannel</code> 将内容接收为字符串或通道。</p>',2)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[24]||(t[24]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," httpResponse: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"HttpResponse"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"https://ktor.io/"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," stringBody: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"String"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," httpResponse."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"receive"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," byteArrayBody: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ByteArray"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," httpResponse."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"receive"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[25]||(t[25]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," httpResponse: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"HttpResponse"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"https://ktor.io/"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," stringBody: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"String"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," httpResponse."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"body"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," byteArrayBody: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ByteArray"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," httpResponse."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"body"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")])])])],-1)])),_:1})]),_:1}),t[85]||(t[85]=i("p",null,[s("安装 "),i("a",{href:"./client-serialization"},"ContentNegotiation"),s(" 插件后，你可以如下所示接收任意对象：")],-1)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[26]||(t[26]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," customer: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Customer"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"http://localhost:8080/customer/3"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[27]||(t[27]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," customer: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Customer"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"http://localhost:8080/customer/3"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"body"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")])])])],-1)])),_:1})]),_:1}),t[86]||(t[86]=h(`<h4 id="streaming-response" tabindex="-1">流式响应 <a class="header-anchor" href="#streaming-response" aria-label="Permalink to &quot;流式响应 {id=&quot;streaming-response&quot;}&quot;">​</a></h4><p>由于请求函数中<a href="#responses">移除了泛型实参</a>，因此接收流式响应需要单独的函数。 为此，已添加带有 <code>prepare</code> 前缀的函数，例如 <code>prepareGet</code> 或 <code>preparePost</code>：</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> suspend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepareGet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(builder: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HttpRequestBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HttpStatement</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> suspend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">preparePost</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(builder: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HttpRequestBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HttpStatement</span></span></code></pre></div><p>下面的示例展示了在这种情况下如何更改你的代码：</p>`,4)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[28]||(t[28]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"HttpStatement"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"https://ktor.io/"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"execute"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { httpResponse "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," channel: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ByteReadChannel"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," httpResponse."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"receive"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    while"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"channel.isClosedForRead) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // Read data")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[29]||(t[29]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"prepareGet"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"https://ktor.io/"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"execute"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { httpResponse "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," channel: "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ByteReadChannel"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," httpResponse."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"body"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    while"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"channel.isClosedForRead) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // Read data")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1}),t[87]||(t[87]=h('<p>你可以在此处找到完整示例：<a href="./client-responses#streaming">流式数据</a>。</p><h3 id="response-validation" tabindex="-1">响应验证 <a class="header-anchor" href="#response-validation" aria-label="Permalink to &quot;响应验证 {id=&quot;response-validation&quot;}&quot;">​</a></h3><p>从 v2.0.0 开始，用于<a href="./client-response-validation">响应验证</a>的 <code>expectSuccess</code> 属性默认设置为 <code>false</code>。 这需要在你的代码中进行以下更改：</p><ul><li>要<a href="./client-response-validation#default">启用默认验证</a>并对非 2xx 响应抛出异常，请将 <code>expectSuccess</code> 属性设置为 <code>true</code>。</li><li>如果你<a href="./client-response-validation#non-2xx">处理非 2xx 异常</a>时使用了 <code>handleResponseExceptionWithRequest</code>，则也需要显式地启用 <code>expectSuccess</code>。</li></ul><h4 id="http-response-validator" tabindex="-1">HttpResponseValidator <a class="header-anchor" href="#http-response-validator" aria-label="Permalink to &quot;HttpResponseValidator {id=&quot;http-response-validator&quot;}&quot;">​</a></h4><p><a href="./client-response-validation#non-2xx">handleResponseException</a> 函数已替换为 <code>handleResponseExceptionWithRequest</code>，后者增加了对 <code>HttpRequest</code> 的访问，以在异常中提供额外信息：</p>',6)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[30]||(t[30]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"HttpResponseValidator"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    handleResponseException"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { exception "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // ...")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[31]||(t[31]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"HttpResponseValidator"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    handleResponseExceptionWithRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { exception, request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // ...")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1}),t[88]||(t[88]=h('<h3 id="serialization-client" tabindex="-1">内容协商和序列化 <a class="header-anchor" href="#serialization-client" aria-label="Permalink to &quot;内容协商和序列化 {id=&quot;serialization-client&quot;}&quot;">​</a></h3><p>Ktor 客户端现在支持内容协商，并与 Ktor 服务器共享序列化库。 主要更改是：</p><ul><li><code>JsonFeature</code> 已弃用，取而代之的是 <code>ContentNegotiation</code>，后者可以在 <code>ktor-client-content-negotiation</code> 构件中找到。</li><li>序列化库已从 <code>ktor-client-*</code> 移动到 <code>ktor-serialization-*</code> 构件。</li></ul><p>你需要更新客户端代码中的<a href="#imports-dependencies-client">依赖项</a>和<a href="#imports-serialization-client">导入</a>，如下所示。</p><h4 id="imports-dependencies-client" tabindex="-1">依赖项 <a class="header-anchor" href="#imports-dependencies-client" aria-label="Permalink to &quot;依赖项 {id=&quot;imports-dependencies-client&quot;}&quot;">​</a></h4><table tabindex="0"><thead><tr><th style="text-align:left;">子系统</th><th style="text-align:center;">1.6.x</th><th style="text-align:right;">2.0.0</th></tr></thead><tbody><tr><td style="text-align:left;"><code>ContentNegotiation</code></td><td style="text-align:center;">n/a</td><td style="text-align:right;"><code>io.ktor:ktor-client-content-negotiation</code></td></tr><tr><td style="text-align:left;">kotlinx.serialization</td><td style="text-align:center;"><code>io.ktor:ktor-client-serialization</code></td><td style="text-align:right;"><code>io.ktor:ktor-serialization-kotlinx-json</code></td></tr><tr><td style="text-align:left;">Gson</td><td style="text-align:center;"><code>io.ktor:ktor-client-gson</code></td><td style="text-align:right;"><code>io.ktor:ktor-serialization-gson</code></td></tr><tr><td style="text-align:left;">Jackson</td><td style="text-align:center;"><code>io.ktor:ktor-client-jackson</code></td><td style="text-align:right;"><code>io.ktor:ktor-serialization-jackson</code></td></tr></tbody></table><h4 id="imports-serialization-client" tabindex="-1">导入 <a class="header-anchor" href="#imports-serialization-client" aria-label="Permalink to &quot;导入 {id=&quot;imports-serialization-client&quot;}&quot;">​</a></h4><table tabindex="0"><thead><tr><th style="text-align:left;">子系统</th><th style="text-align:center;">1.6.x</th><th style="text-align:right;">2.0.0</th></tr></thead><tbody><tr><td style="text-align:left;"><code>ContentNegotiation</code></td><td style="text-align:center;">n/a</td><td style="text-align:right;"><code>import io.ktor.client.plugins.contentnegotiation.*</code></td></tr><tr><td style="text-align:left;">kotlinx.serialization</td><td style="text-align:center;"><code>import io.ktor.client.features.json.*</code></td><td style="text-align:right;"><code>import io.ktor.serialization.kotlinx.json.*</code></td></tr><tr><td style="text-align:left;">Gson</td><td style="text-align:center;"><code>import io.ktor.client.features.json.*</code></td><td style="text-align:right;"><code>import io.ktor.serialization.gson.*</code></td></tr><tr><td style="text-align:left;">Jackson</td><td style="text-align:center;"><code>import io.ktor.client.features.json.*</code></td><td style="text-align:right;"><code>import io.ktor.serialization.jackson.*</code></td></tr></tbody></table><h3 id="bearer-认证" tabindex="-1">Bearer 认证 <a class="header-anchor" href="#bearer-认证" aria-label="Permalink to &quot;Bearer 认证&quot;">​</a></h3><p><a href="./client-bearer-auth">refreshTokens</a> 函数现在使用 <code>RefreshTokenParams</code> 实例作为 <a href="https://kotlinlang.org/docs/scope-functions.html#context-object-this-or-it" target="_blank" rel="noreferrer">lambda 接收者</a> (<code>this</code>)，而不是 <code>HttpResponse</code> lambda 实参 (<code>it</code>)：</p>',10)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[32]||(t[32]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bearer"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    refreshTokens"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {  "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// it: HttpResponse")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // ...")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[33]||(t[33]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bearer"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    refreshTokens"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// this: RefreshTokenParams")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // ...")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1}),t[89]||(t[89]=h('<p><code>RefreshTokenParams</code> 暴露了以下属性：</p><ul><li><code>response</code> 用于访问响应形参；</li><li><code>client</code> 用于发出请求以刷新 token；</li><li><code>oldTokens</code> 用于访问使用 <code>loadTokens</code> 获取的 token。</li></ul><h3 id="http-send" tabindex="-1">HttpSend <a class="header-anchor" href="#http-send" aria-label="Permalink to &quot;HttpSend {id=&quot;http-send&quot;}&quot;">​</a></h3><p><a href="./client-http-send">HttpSend</a> 插件的 API 更改如下：</p>',4)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[34]||(t[34]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"client[HttpSend]."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"intercept"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { originalCall, request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (originalCall."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"something"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," newCall "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," execute"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // ...")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[35]||(t[35]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"plugin"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpSend)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"intercept"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," originalCall "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," execute"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (originalCall."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"something"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," newCall "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," execute"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // ...")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1}),t[90]||(t[90]=i("p",null,[s("请注意，在 v2.0.0 中，索引访问不可用于访问插件。请改用 "),i("a",{href:"#client-get"},"HttpClient.plugin"),s(" 函数。")],-1)),t[91]||(t[91]=i("h3",{id:"client-get",tabindex:"-1"},[s("HttpClient.get(plugin: HttpClientPlugin) 函数已移除 "),i("a",{class:"header-anchor",href:"#client-get","aria-label":'Permalink to "HttpClient.get(plugin: HttpClientPlugin) 函数已移除 {id="client-get"}"'},"​")],-1)),t[92]||(t[92]=i("p",null,[s("在 2.0.0 版本中，接受客户端插件的 "),i("code",null,"HttpClient.get"),s(" 函数已移除。请改用 "),i("code",null,"HttpClient.plugin"),s(" 函数。")],-1)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[36]||(t[36]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpSend)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"intercept"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},". }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// or")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"client[HttpSend]."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"intercept"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},". }")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[37]||(t[37]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"plugin"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HttpSend)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"intercept"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},". }")])])])],-1)])),_:1})]),_:1}),t[93]||(t[93]=h('<h3 id="feature-plugin-client" tabindex="-1">Feature 已重命名为 Plugin <a class="header-anchor" href="#feature-plugin-client" aria-label="Permalink to &quot;Feature 已重命名为 Plugin {id=&quot;feature-plugin-client&quot;}&quot;">​</a></h3><p>至于 Ktor 服务器，客户端 API 中的 <code>Feature</code> 已重命名为 <code>Plugin</code>。 这可能会影响你的应用程序，如下所述。</p><h4 id="feature-plugin-imports-client" tabindex="-1">导入 <a class="header-anchor" href="#feature-plugin-imports-client" aria-label="Permalink to &quot;导入 {id=&quot;feature-plugin-imports-client&quot;}&quot;">​</a></h4><p>更新<a href="./client-plugins#install">安装插件</a>的导入：</p>',4)),i("table",null,[t[62]||(t[62]=i("tr",null,[i("td",null,"子系统"),i("td",null,"1.6.x"),i("td",null,"2.0.0")],-1)),i("tr",null,[i("td",null,[e(o,null,{default:a(()=>[i("li",null,[e(k,{href:"/ktor/client-default-request",summary:"The DefaultRequest plugin allows you to configure default parameters for all requests."},{default:a(()=>t[38]||(t[38]=[s("默认请求")])),_:1})]),i("li",null,[e(k,{href:"/ktor/client-user-agent",summary:"undefined"},{default:a(()=>t[39]||(t[39]=[s("用户代理")])),_:1})]),i("li",null,[e(k,{href:"/ktor/client-text-and-charsets",summary:"undefined"},{default:a(()=>t[40]||(t[40]=[s("字符集")])),_:1})]),i("li",null,[e(k,{href:"/ktor/client-response-validation",summary:"Learn how to validate a response depending on its status code."},{default:a(()=>t[41]||(t[41]=[s("响应验证")])),_:1})]),i("li",null,[e(k,{href:"/ktor/client-timeout",summary:"Code example: %example_name%"},{default:a(()=>t[42]||(t[42]=[s("超时")])),_:1})]),i("li",null,[e(k,{href:"/ktor/client-caching",summary:"The HttpCache plugin allows you to save previously fetched resources in an in-memory or persistent cache."},{default:a(()=>t[43]||(t[43]=[s("HttpCache")])),_:1})]),i("li",null,[e(k,{href:"/ktor/client-http-send",summary:"Code example: %example_name%"},{default:a(()=>t[44]||(t[44]=[s("HttpSend")])),_:1})])]),_:1})]),t[45]||(t[45]=i("td",null,"`import io.ktor.client.features.*`",-1)),t[46]||(t[46]=i("td",null,"`import io.ktor.client.plugins.*`",-1))]),i("tr",null,[i("td",null,[e(k,{href:"/ktor/client-auth",summary:"The Auth plugin handles authentication and authorization in your client application."},{default:a(()=>t[47]||(t[47]=[s("认证")])),_:1})]),t[48]||(t[48]=i("td",null," ` import io.ktor.client.features.auth.* ` ` import io.ktor.client.features.auth.providers.* ` ",-1)),t[49]||(t[49]=i("td",null," ` import io.ktor.client.plugins.auth.* ` ` import io.ktor.client.plugins.auth.providers.* ` ",-1))]),i("tr",null,[i("td",null,[e(k,{href:"/ktor/client-cookies",summary:"The HttpCookies plugin handles cookies automatically and keep them between calls in a storage."},{default:a(()=>t[50]||(t[50]=[s("Cookie")])),_:1})]),t[51]||(t[51]=i("td",null,"`import io.ktor.client.features.cookies.*`",-1)),t[52]||(t[52]=i("td",null,"`import io.ktor.client.plugins.cookies.*`",-1))]),i("tr",null,[i("td",null,[e(k,{href:"/ktor/client-logging",summary:"Required dependencies: io.ktor:ktor-client-logging Code example: %example_name%"},{default:a(()=>t[53]||(t[53]=[s("日志")])),_:1})]),t[54]||(t[54]=i("td",null,"`import io.ktor.client.features.logging.*`",-1)),t[55]||(t[55]=i("td",null,"`import io.ktor.client.plugins.logging.*`",-1))]),i("tr",null,[i("td",null,[e(k,{href:"/ktor/client-websockets",summary:"The Websockets plugin allows you to create a multi-way communication session between a server and a client."},{default:a(()=>t[56]||(t[56]=[s("WebSockets")])),_:1})]),t[57]||(t[57]=i("td",null,"`import io.ktor.client.features.websocket.*`",-1)),t[58]||(t[58]=i("td",null,"`import io.ktor.client.plugins.websocket.*`",-1))]),i("tr",null,[i("td",null,[e(k,{href:"/ktor/client-content-encoding",summary:"The ContentEncoding plugin allows you to enable specified compression algorithms (such as 'gzip' and 'deflate') and configure their settings."},{default:a(()=>t[59]||(t[59]=[s("内容编码")])),_:1})]),t[60]||(t[60]=i("td",null,"`import io.ktor.client.features.compression.*`",-1)),t[61]||(t[61]=i("td",null,"`import io.ktor.client.plugins.compression.*`",-1))])]),t[94]||(t[94]=h('<h4 id="feature-plugin-custom-client" tabindex="-1">自定义插件 <a class="header-anchor" href="#feature-plugin-custom-client" aria-label="Permalink to &quot;自定义插件 {id=&quot;feature-plugin-custom-client&quot;}&quot;">​</a></h4><p><code>HttpClientFeature</code> 接口已重命名为 <code>HttpClientPlugin</code>。</p><h3 id="new-mm" tabindex="-1">Native 目标的全新内存模型 <a class="header-anchor" href="#new-mm" aria-label="Permalink to &quot;Native 目标的全新内存模型 {id=&quot;new-mm&quot;}&quot;">​</a></h3><p>从 v2.0.0 开始，在 <a href="./client-engines#native">Native</a> 目标上使用 Ktor 客户端需要启用全新的 Kotlin/Native 内存模型：<a href="./https://github.com/JetBrains/kotlin/blob/master/kotlin-native/NEW_MM#enable-the-new-mm">启用新内存模型</a>。</p><blockquote><p>从 v2.2.0 开始，全新的 Kotlin/Native 内存模型<a href="./migration-to-22x#new-mm">默认启用</a>。</p></blockquote><h3 id="darwin" tabindex="-1">&#39;Ios&#39; 引擎已重命名为 &#39;Darwin&#39; <a class="header-anchor" href="#darwin" aria-label="Permalink to &quot;&#39;Ios&#39; 引擎已重命名为 &#39;Darwin&#39; {id=&quot;darwin&quot;}&quot;">​</a></h3><p>鉴于 <code>Ios</code> <a href="./client-engines">引擎</a>在 v2.0.0 中不仅面向 iOS，还面向其他操作系统，包括 macOS 或 tvOS，因此它已重命名为 <code>Darwin</code>。这导致了以下更改：</p><ul><li><code>io.ktor:ktor-client-ios</code> 构件已重命名为 <code>io.ktor:ktor-client-darwin</code>。</li><li>要创建 <code>HttpClient</code> 实例，你需要将 <code>Darwin</code> 类作为实参传递。</li><li><code>IosClientEngineConfig</code> 配置类已重命名为 <code>DarwinClientEngineConfig</code>。</li></ul><p>要了解如何配置 <code>Darwin</code> 引擎，请参见 <a href="./client-engines#darwin">Darwin</a> 部分。</p><h3 id="client-ws-package" tabindex="-1">WebSockets 代码已移动到 &#39;websockets&#39; 包 <a class="header-anchor" href="#client-ws-package" aria-label="Permalink to &quot;WebSockets 代码已移动到 &#39;websockets&#39; 包 {id=&quot;client-ws-package&quot;}&quot;">​</a></h3><p>WebSockets 代码已从 <code>http-cio</code> 移动到 <code>websockets</code> 包。这需要如下更新导入：</p><table tabindex="0"><thead><tr><th style="text-align:left;">1.6.x</th><th style="text-align:right;">2.0.0</th></tr></thead><tbody><tr><td style="text-align:left;"><code>import io.ktor.http.cio.websocket.*</code></td><td style="text-align:right;"><code>import io.ktor.websocket.*</code></td></tr></tbody></table><h3 id="default-request" tabindex="-1">默认请求 <a class="header-anchor" href="#default-request" aria-label="Permalink to &quot;默认请求 {id=&quot;default-request&quot;}&quot;">​</a></h3><p><a href="./client-default-request">DefaultRequest</a> 插件使用 <code>DefaultRequestBuilder</code> 配置类而不是 <code>HttpRequestBuilder</code>：</p>',14)),e(n,{group:"ktor_versions"},{default:a(()=>[e(l,{title:"1.6.x","group-key":"1_6"},{default:a(()=>t[63]||(t[63]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HttpClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(CIO) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    defaultRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // this: HttpRequestBuilder")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1}),e(l,{title:"2.0.0","group-key":"2_0"},{default:a(()=>t[64]||(t[64]=[i("div",{class:"language-kotlin vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"kotlin"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"val"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HttpClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(CIO) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    defaultRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // this: DefaultRequestBuilder")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])])],-1)])),_:1})]),_:1})])}const b=p(c,[["render",y]]);export{x as __pageData,b as default};
