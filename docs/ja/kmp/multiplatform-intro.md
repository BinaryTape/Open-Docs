[//]: # (title: Kotlin Multiplatform の概要)

マルチプラットフォームプログラミングのサポートは、Kotlin の主要な利点の一つです。これにより、[異なるプラットフォーム](multiplatform-dsl-reference.md#targets)向けに同じコードを記述・保守する時間を削減しつつ、ネイティブプログラミングの柔軟性と利点を維持できます。

![Kotlin Multiplatform](kotlin-multiplatform.svg){width=700}

## 主要な概念を学ぶ

Kotlin Multiplatform を使用すると、モバイル、Web、デスクトップなど、さまざまなプラットフォームでコードを共有できます。コードがコンパイルされるプラットフォームは、_ターゲット_のリストによって定義されます。

各ターゲットには、独自の依存関係とコンパイラオプションを持つソースファイルのセットを表す、対応する_ソースセット_があります。たとえば JVM 用の`jvmMain`のようなプラットフォーム固有のソースセットは、プラットフォーム固有のライブラリや API を利用できます。

ターゲットのサブセット間でコードを共有するために、中間ソースセットが使用されます。たとえば、`appleMain`ソースセットは、すべての Apple プラットフォーム間で共有されるコードを表します。すべてのプラットフォーム間で共有され、宣言されたすべてのターゲットにコンパイルされるコードには、独自のソースセット`commonMain`があります。これはプラットフォーム固有の API を使用できませんが、マルチプラットフォームライブラリを利用できます。

特定のターゲット向けにコンパイルする場合、Kotlin は共通ソースセット、関連する中間ソースセット、およびターゲット固有のソースセットを結合します。

このトピックの詳細については、以下を参照してください。

*   [Kotlin Multiplatform プロジェクト構造の基本](multiplatform-discover-project.md)
*   [マルチプラットフォームプロジェクト構造の高度な概念](multiplatform-advanced-project-structure.md)

## コード共有メカニズムを使用する

類似のターゲットのサブセット間でコードを共有する方が便利な場合があります。Kotlin Multiplatform は、_デフォルト階層テンプレート_を使用して、それらの作成を簡素化する方法を提供します。これは、プロジェクトで指定したターゲットに基づいて作成される、中間ソースセットの事前定義されたリストを含みます。

共有コードからプラットフォーム固有の API にアクセスするには、別の Kotlin メカニズムである、_期待される宣言と実際の宣言_を使用できます。この方法では、共通コードでプラットフォーム固有の API を`expect`すると宣言しつつ、各ターゲットプラットフォームに対して個別の`actual`実装を提供できます。このメカニズムは、関数、クラス、インターフェースなど、さまざまな Kotlin の概念で使用できます。たとえば、共通コードで関数を定義し、対応するソースセットでプラットフォーム固有のライブラリを使用してその実装を提供できます。

このトピックの詳細については、以下を参照してください。

*   [プラットフォームでコードを共有する](multiplatform-share-on-platforms.md)
*   [期待される宣言と実際の宣言](multiplatform-expect-actual.md)
*   [階層型プロジェクト構造](multiplatform-hierarchy.md)

## 依存関係を追加する

Kotlin Multiplatform プロジェクトは、外部ライブラリや他のマルチプラットフォームプロジェクトに依存できます。共通コードの場合、共通ソースセットにマルチプラットフォームライブラリへの依存関係を追加できます。Kotlin は、適切なプラットフォーム固有の部品を自動的に解決し、他のソースセットに追加します。プラットフォーム固有の API のみが要求される場合は、対応するソースセットに依存関係を追加します。

Kotlin Multiplatform プロジェクトに Android 固有の依存関係を追加することは、純粋な Android プロジェクトで追加することと同様です。iOS 固有の依存関係を扱う場合、追加の設定なしに Apple SDK フレームワークをシームレスに統合できます。外部ライブラリやフレームワークの場合、Kotlin は Objective-C および Swift との相互運用性を提供します。

このトピックの詳細については、以下を参照してください。

*   [マルチプラットフォームライブラリへの依存関係を追加する](multiplatform-add-dependencies.md)
*   [Android ライブラリへの依存関係を追加する](multiplatform-android-dependencies.md)
*   [iOS ライブラリへの依存関係を追加する](multiplatform-ios-dependencies.md)

## iOS との統合を設定する

マルチプラットフォームプロジェクトが iOS をターゲットとする場合、Kotlin Multiplatform 共有モジュールを iOS アプリと統合するように設定できます。

そのために、iOS フレームワークを生成し、それを iOS プロジェクトにローカルまたはリモートの依存関係として追加します。

*   **ローカル統合**: マルチプラットフォームプロジェクトと Xcode プロジェクトを特別なスクリプトで直接接続するか、ローカル Pod 依存関係を含むセットアップには CocoaPods 依存関係マネージャーを使用します。
*   **リモート統合**: XCFrameworks を使用して SPM 依存関係を設定するか、CocoaPods を通じて共有モジュールを配布します。

このトピックの詳細については、[iOS 統合方法](multiplatform-ios-integration-overview.md)を参照してください。

## コンパイルを設定する

各ターゲットは、異なる目的のために複数のコンパイルを持つことができます。通常は本番用またはテスト用ですが、カスタムコンパイルを定義することもできます。

Kotlin Multiplatform を使用すると、プロジェクト内のすべてのコンパイルを設定したり、ターゲット内で特定のコンパイルを設定したり、個別のコンパイルを作成したりすることもできます。コンパイルを設定する際には、コンパイラオプションを変更したり、依存関係を管理したり、ネイティブ言語との相互運用性を設定したりできます。

このトピックの詳細については、[コンパイルを設定する](multiplatform-configure-compilations.md)を参照してください。

## 最終バイナリをビルドする

デフォルトでは、ターゲットは`.klib`アーティファクトにコンパイルされます。これは Kotlin/Native 自体によって依存関係として消費できますが、実行したりネイティブライブラリとして使用したりすることはできません。しかし、Kotlin Multiplatform は最終的なネイティブバイナリをビルドするための追加のメカニズムを提供します。

実行可能バイナリ、共有ライブラリ、静的ライブラリ、または Objective-C フレームワークを作成でき、それぞれ異なるビルドタイプ用に設定可能です。Kotlin はまた、iOS 統合のためのユニバーサル（ファット）フレームワークおよび XCFrameworks をビルドする方法も提供します。

このトピックの詳細については、[ネイティブバイナリをビルドする](multiplatform-build-native-binaries.md)を参照してください。

## マルチプラットフォームライブラリを作成する

共通コードと、JVM、Web、ネイティブプラットフォーム向けのプラットフォーム固有の実装を持つマルチプラットフォームライブラリを作成できます。

Kotlin Multiplatform ライブラリを公開するには、Gradle ビルドスクリプトで特定の構成が必要です。公開には、Maven リポジトリと`maven-publish`プラグインを使用できます。公開されると、マルチプラットフォームライブラリは他のクロスプラットフォームプロジェクトの依存関係として使用できます。

このトピックの詳細については、[マルチプラットフォームライブラリを公開する](multiplatform-publish-lib-setup.md)を参照してください。

## 参考

*   [Kotlin Multiplatform Gradle プラグインの DSL リファレンス](multiplatform-dsl-reference.md)
*   [Kotlin Multiplatform 互換性ガイド](multiplatform-compatibility-guide.md)